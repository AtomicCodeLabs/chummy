{"version":3,"sources":["webpack:///./node_modules/react-side-effect/lib/index.js","webpack:///./node_modules/shallowequal/index.js","webpack:///./src/components/Layout/main.module.css","webpack:///./src/components/View/index.js","webpack:///./node_modules/react-helmet/lib/Helmet.js","webpack:///./src/components/Header/index.js","webpack:///./src/components/Layout/index.js","webpack:///./node_modules/react-fast-compare/index.js","webpack:///./node_modules/@firebase/installations/dist/index.esm.js","webpack:///./node_modules/react-helmet/lib/HelmetConstants.js","webpack:///./node_modules/idb/build/idb.js","webpack:///./node_modules/react-helmet/lib/HelmetUtils.js"],"names":["_interopDefault","ex","React","React__default","shallowEqual","_defineProperty","obj","key","value","Object","defineProperty","enumerable","configurable","writable","canUseDOM","window","document","createElement","module","exports","reducePropsToState","handleStateChangeOnClient","mapStateOnServer","Error","WrappedComponent","state","mountedInstances","emitChange","map","instance","props","SideEffect","_Component","subClass","superClass","apply","this","arguments","prototype","create","constructor","__proto__","peek","rewind","recordedState","undefined","_proto","shouldComponentUpdate","nextProps","componentWillMount","push","componentDidUpdate","componentWillUnmount","index","indexOf","splice","render","Component","displayName","name","getDisplayName","objA","objB","compare","compareContext","ret","call","keysA","keys","keysB","length","bHasOwnProperty","hasOwnProperty","bind","idx","valueA","valueB","View","title","children","className","defaultProps","__esModule","Helmet","_extends","assign","target","i","source","_createClass","defineProperties","descriptor","Constructor","protoProps","staticProps","_react2","_interopRequireDefault","_propTypes2","_reactSideEffect2","_reactFastCompare2","_HelmetUtils","_HelmetConstants","default","_objectWithoutProperties","_classCallCheck","TypeError","_possibleConstructorReturn","self","ReferenceError","_class","_temp","HelmetSideEffects","handleClientStateChange","HelmetExport","_React$Component","HelmetWrapper","setPrototypeOf","_inherits","mapNestedChildrenToProps","child","nestedChildren","type","TAG_NAMES","SCRIPT","NOSCRIPT","innerHTML","STYLE","cssText","flattenArrayTypeChildren","_ref","_extends2","arrayTypeChildren","newChildProps","concat","mapObjectTypeChildren","_ref2","_extends3","_extends4","newProps","TITLE","titleAttributes","BODY","bodyAttributes","HTML","htmlAttributes","mapArrayTypeChildrenToProps","newFlattenedProps","forEach","arrayChildName","_extends5","warnOnInvalidChildren","mapChildrenToProps","_this2","Children","_child$props","childProps","convertReactPropstoHtmlAttributes","LINK","META","_props","set","propTypes","base","object","oneOfType","arrayOf","node","defaultTitle","string","defer","bool","encodeSpecialCharacters","link","meta","noscript","onChangeClientState","func","script","style","titleTemplate","mappedState","baseTag","linkTags","metaTags","noscriptTags","scriptTags","styleTags","renderStatic","Header","to","Layout","styles","main","isArray","Array","keyList","hasProp","hasElementType","Element","a","b","equal","arrA","arrB","dateA","Date","dateB","getTime","regexpA","RegExp","regexpB","toString","$$typeof","error","message","match","number","console","warn","_a","ERROR_DESCRIPTION_MAP","ERROR_FACTORY","isServerError","code","includes","getInstallationsEndpoint","INSTALLATIONS_API_URL","projectId","extractAuthTokenInfoFromResponse","response","token","requestStatus","expiresIn","responseExpiresIn","Number","replace","creationTime","now","getErrorFromResponse","requestName","responseJson","errorData","label","json","sent","serverCode","serverMessage","serverStatus","status","getHeaders","apiKey","Headers","Accept","getHeadersWithAuth","appConfig","refreshToken","headers","append","INTERNAL_AUTH_VERSION","getAuthorizationHeader","retryIfServerError","fn","result","createInstallationRequest","fid","endpoint","body","request","responseValue","_b","authVersion","appId","sdkVersion","method","JSON","stringify","fetch","ok","registrationStatus","authToken","sleep","ms","Promise","resolve","setTimeout","VALID_FID_PATTERN","generateFid","fidByteArray","Uint8Array","crypto","msCrypto","getRandomValues","array","btoa","String","fromCharCode","substr","encode","test","getKey","appName","fidChangeCallbacks","Map","fidChanged","callFidChangeCallbacks","channel","getBroadcastChannel","postMessage","closeBroadcastChannel","broadcastFidChange","e_1","callbacks","get","callbacks_1","callbacks_1_1","next","done","callback","e_1_1","return","broadcastChannel","BroadcastChannel","onmessage","e","data","size","close","OBJECT_STORE_NAME","dbPromise","getDbPromise","upgradeDB","oldVersion","createObjectStore","db","tx","objectStore","oldValue","transaction","put","complete","remove","delete","update","updateFn","store","newValue","getInstallationEntry","registrationPromise","installationEntry","oldEntry","clearTimedOutRequest","updateOrCreateInstallationEntry","entryWithPromise","navigator","onLine","registrationPromiseWithError","reject","inProgressEntry","registrationTime","registeredInstallationEntry","trys","customData","registerInstallation","waitUntilFidRegistration","triggerRegistrationIfNecessary","entry","updateInstallationRequest","generateAuthTokenRequest","platformLoggerProvider","platformLogger","getGenerateAuthTokenEndpoint","getImmediate","optional","getPlatformInfoString","installation","refreshAuthToken","dependencies","forceRefresh","tokenPromise","isEntryRegistered","oldAuthToken","isAuthTokenExpired","isAuthTokenValid","updateAuthTokenRequest","waitUntilAuthTokenRequest","inProgressAuthToken","requestTime","makeAuthTokenRequestInProgressEntry","updatedInstallationEntry","fetchAuthTokenFromServer","completeInstallationRegistration","deleteInstallationRequest","getDeleteEndpoint","_onIdChange","callbackSet","Set","add","addCallback","removeCallback","getMissingValueError","valueName","INTERNAL","registerComponent","container","app","getProvider","options","configKeys_1","configKeys_1_1","keyName","extractAppConfig","getId","catch","_getId","getToken","_getToken","deleteInstallation","onIdChange","registerVersion","ATTRIBUTE_NAMES","BASE","HEAD","REACT_TAG_MAP","VALID_TAG_NAMES","TAG_PROPERTIES","CHARSET","CSS_TEXT","HREF","HTTPEQUIV","INNER_HTML","ITEM_PROP","NAME","PROPERTY","REL","SRC","accesskey","charset","class","contenteditable","contextmenu","itemprop","tabindex","HELMET_PROPS","DEFAULT_TITLE","DEFER","ENCODE_SPECIAL_CHARACTERS","ON_CHANGE_CLIENT_STATE","TITLE_TEMPLATE","HTML_TAG_MAP","reduce","SELF_CLOSING_TAGS","HELMET_ATTRIBUTE","toArray","arr","slice","promisifyRequest","onsuccess","onerror","promisifyRequestCall","args","p","then","promisifyCursorRequestCall","Cursor","proxyProperties","ProxyClass","targetProp","properties","prop","val","proxyRequestMethods","proxyMethods","proxyCursorRequestMethods","Index","_index","cursor","_cursor","_request","ObjectStore","_store","Transaction","idbTransaction","_tx","oncomplete","onabort","UpgradeDB","_db","DB","IDBIndex","IDBCursor","methodName","createIndex","IDBObjectStore","IDBTransaction","IDBDatabase","funcName","nativeObject","getAll","query","count","items","iterateCursor","continue","openDb","version","upgradeCallback","indexedDB","onupgradeneeded","event","deleteDb","factory","requestAnimationFrame","_typeof","Symbol","iterator","_objectAssign2","clock","str","getTitleFromPropsList","propsList","innermostTitle","getInnermostProperty","innermostTemplate","innermostDefaultTitle","getOnChangeClientState","getAttributesFromPropsList","tagType","filter","tagAttrs","current","getBaseTagFromPropsList","primaryAttributes","reverse","innermostBaseTag","tag","lowerCaseAttributeKey","toLowerCase","getTagsFromPropsList","tagName","approvedSeenTags","approvedTags","instanceTags","instanceSeenTags","primaryAttributeKey","attributeKey","tagUnion","property","rafPolyfill","currentTime","cafPolyfill","id","clearTimeout","webkitRequestAnimationFrame","mozRequestAnimationFrame","global","cancelAnimationFrame","webkitCancelAnimationFrame","mozCancelAnimationFrame","msg","_helmetCallback","commitTagChanges","newState","cb","updateAttributes","updateTitle","tagUpdates","updateTags","addedTags","removedTags","_tagUpdates$tagType","newTags","oldTags","flattenArray","possibleArray","join","attributes","elementTag","getElementsByTagName","helmetAttributeString","getAttribute","helmetAttributes","split","attributesToRemove","attributeKeys","attribute","setAttribute","indexToSave","_i","removeAttribute","tags","headElement","head","querySelector","tagNodes","querySelectorAll","indexToDelete","newElement","styleSheet","appendChild","createTextNode","some","existingTag","isEqualNode","parentNode","removeChild","generateElementAttributesAsString","attr","convertElementAttributestoReactProps","initProps","getMethodsForTag","toComponent","_initProps","attributeString","flattenedTitle","generateTitleAsString","_mappedTag","mappedTag","mappedAttribute","content","dangerouslySetInnerHTML","__html","generateTagsAsReactComponent","attributeHtml","tagContent","isSelfClosing","generateTagsAsString","initAttributes","_ref$title"],"mappings":"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","file":"commons-44647456f2d5b371ef33.js","sourcesContent":["'use strict';\n\nfunction _interopDefault(ex) {\n  return ex && typeof ex === 'object' && 'default' in ex ? ex['default'] : ex;\n}\n\nvar React = require('react');\n\nvar React__default = _interopDefault(React);\n\nvar shallowEqual = _interopDefault(require('shallowequal'));\n\nfunction _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}\n\nfunction _inheritsLoose(subClass, superClass) {\n  subClass.prototype = Object.create(superClass.prototype);\n  subClass.prototype.constructor = subClass;\n  subClass.__proto__ = superClass;\n}\n\nvar canUseDOM = !!(typeof window !== 'undefined' && window.document && window.document.createElement);\n\nfunction withSideEffect(reducePropsToState, handleStateChangeOnClient, mapStateOnServer) {\n  if (typeof reducePropsToState !== 'function') {\n    throw new Error('Expected reducePropsToState to be a function.');\n  }\n\n  if (typeof handleStateChangeOnClient !== 'function') {\n    throw new Error('Expected handleStateChangeOnClient to be a function.');\n  }\n\n  if (typeof mapStateOnServer !== 'undefined' && typeof mapStateOnServer !== 'function') {\n    throw new Error('Expected mapStateOnServer to either be undefined or a function.');\n  }\n\n  function getDisplayName(WrappedComponent) {\n    return WrappedComponent.displayName || WrappedComponent.name || 'Component';\n  }\n\n  return function wrap(WrappedComponent) {\n    if (typeof WrappedComponent !== 'function') {\n      throw new Error('Expected WrappedComponent to be a React component.');\n    }\n\n    var mountedInstances = [];\n    var state;\n\n    function emitChange() {\n      state = reducePropsToState(mountedInstances.map(function (instance) {\n        return instance.props;\n      }));\n\n      if (SideEffect.canUseDOM) {\n        handleStateChangeOnClient(state);\n      } else if (mapStateOnServer) {\n        state = mapStateOnServer(state);\n      }\n    }\n\n    var SideEffect = /*#__PURE__*/function (_Component) {\n      _inheritsLoose(SideEffect, _Component);\n\n      function SideEffect() {\n        return _Component.apply(this, arguments) || this;\n      } // Try to use displayName of wrapped component\n      // Expose canUseDOM so tests can monkeypatch it\n\n\n      SideEffect.peek = function peek() {\n        return state;\n      };\n\n      SideEffect.rewind = function rewind() {\n        if (SideEffect.canUseDOM) {\n          throw new Error('You may only call rewind() on the server. Call peek() to read the current state.');\n        }\n\n        var recordedState = state;\n        state = undefined;\n        mountedInstances = [];\n        return recordedState;\n      };\n\n      var _proto = SideEffect.prototype;\n\n      _proto.shouldComponentUpdate = function shouldComponentUpdate(nextProps) {\n        return !shallowEqual(nextProps, this.props);\n      };\n\n      _proto.componentWillMount = function componentWillMount() {\n        mountedInstances.push(this);\n        emitChange();\n      };\n\n      _proto.componentDidUpdate = function componentDidUpdate() {\n        emitChange();\n      };\n\n      _proto.componentWillUnmount = function componentWillUnmount() {\n        var index = mountedInstances.indexOf(this);\n        mountedInstances.splice(index, 1);\n        emitChange();\n      };\n\n      _proto.render = function render() {\n        return React__default.createElement(WrappedComponent, this.props);\n      };\n\n      return SideEffect;\n    }(React.Component);\n\n    _defineProperty(SideEffect, \"displayName\", \"SideEffect(\" + getDisplayName(WrappedComponent) + \")\");\n\n    _defineProperty(SideEffect, \"canUseDOM\", canUseDOM);\n\n    return SideEffect;\n  };\n}\n\nmodule.exports = withSideEffect;","//\nmodule.exports = function shallowEqual(objA, objB, compare, compareContext) {\n  var ret = compare ? compare.call(compareContext, objA, objB) : void 0;\n\n  if (ret !== void 0) {\n    return !!ret;\n  }\n\n  if (objA === objB) {\n    return true;\n  }\n\n  if (typeof objA !== \"object\" || !objA || typeof objB !== \"object\" || !objB) {\n    return false;\n  }\n\n  var keysA = Object.keys(objA);\n  var keysB = Object.keys(objB);\n\n  if (keysA.length !== keysB.length) {\n    return false;\n  }\n\n  var bHasOwnProperty = Object.prototype.hasOwnProperty.bind(objB); // Test for A's keys different from B.\n\n  for (var idx = 0; idx < keysA.length; idx++) {\n    var key = keysA[idx];\n\n    if (!bHasOwnProperty(key)) {\n      return false;\n    }\n\n    var valueA = objA[key];\n    var valueB = objB[key];\n    ret = compare ? compare.call(compareContext, valueA, valueB, key) : void 0;\n\n    if (ret === false || ret === void 0 && valueA !== valueB) {\n      return false;\n    }\n  }\n\n  return true;\n};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"main\":\"main-module--main--3lKgP\"};","import React from 'react';\nimport PropTypes from 'prop-types';\n\nconst View = ({ title, children }) => (\n  <div className=\"w-full bg-gray-100 rounded px-8 pt-6 pb-8 mb-4\">\n    <div className=\"w-1/3\" />\n    <div className=\"bg-white shadow-md rounded px-4 pt-6 pb-8 mb-4 md:mx-24 lg:mx-64\">\n      <h1 className=\"text-lg font-bold\">{title}</h1>\n\n      <div className=\"my-8\">{children}</div>\n    </div>\n    <div className=\"w-1/3\" />\n  </div>\n);\n\nView.propTypes = {\n  title: PropTypes.string.isRequired,\n  children: PropTypes.node\n};\n\nView.defaultProps = {\n  children: null\n};\n\nexport default View;\n","exports.__esModule = true;\nexports.Helmet = undefined;\n\nvar _extends = Object.assign || function (target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = arguments[i];\n\n    for (var key in source) {\n      if (Object.prototype.hasOwnProperty.call(source, key)) {\n        target[key] = source[key];\n      }\n    }\n  }\n\n  return target;\n};\n\nvar _createClass = function () {\n  function defineProperties(target, props) {\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true;\n      Object.defineProperty(target, descriptor.key, descriptor);\n    }\n  }\n\n  return function (Constructor, protoProps, staticProps) {\n    if (protoProps) defineProperties(Constructor.prototype, protoProps);\n    if (staticProps) defineProperties(Constructor, staticProps);\n    return Constructor;\n  };\n}();\n\nvar _react = require(\"react\");\n\nvar _react2 = _interopRequireDefault(_react);\n\nvar _propTypes = require(\"prop-types\");\n\nvar _propTypes2 = _interopRequireDefault(_propTypes);\n\nvar _reactSideEffect = require(\"react-side-effect\");\n\nvar _reactSideEffect2 = _interopRequireDefault(_reactSideEffect);\n\nvar _reactFastCompare = require(\"react-fast-compare\");\n\nvar _reactFastCompare2 = _interopRequireDefault(_reactFastCompare);\n\nvar _HelmetUtils = require(\"./HelmetUtils.js\");\n\nvar _HelmetConstants = require(\"./HelmetConstants.js\");\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    default: obj\n  };\n}\n\nfunction _objectWithoutProperties(obj, keys) {\n  var target = {};\n\n  for (var i in obj) {\n    if (keys.indexOf(i) >= 0) continue;\n    if (!Object.prototype.hasOwnProperty.call(obj, i)) continue;\n    target[i] = obj[i];\n  }\n\n  return target;\n}\n\nfunction _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\n\nfunction _possibleConstructorReturn(self, call) {\n  if (!self) {\n    throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n  }\n\n  return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self;\n}\n\nfunction _inherits(subClass, superClass) {\n  if (typeof superClass !== \"function\" && superClass !== null) {\n    throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass);\n  }\n\n  subClass.prototype = Object.create(superClass && superClass.prototype, {\n    constructor: {\n      value: subClass,\n      enumerable: false,\n      writable: true,\n      configurable: true\n    }\n  });\n  if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass;\n}\n\nvar Helmet = function Helmet(Component) {\n  var _class, _temp;\n\n  return _temp = _class = function (_React$Component) {\n    _inherits(HelmetWrapper, _React$Component);\n\n    function HelmetWrapper() {\n      _classCallCheck(this, HelmetWrapper);\n\n      return _possibleConstructorReturn(this, _React$Component.apply(this, arguments));\n    }\n\n    HelmetWrapper.prototype.shouldComponentUpdate = function shouldComponentUpdate(nextProps) {\n      return !(0, _reactFastCompare2.default)(this.props, nextProps);\n    };\n\n    HelmetWrapper.prototype.mapNestedChildrenToProps = function mapNestedChildrenToProps(child, nestedChildren) {\n      if (!nestedChildren) {\n        return null;\n      }\n\n      switch (child.type) {\n        case _HelmetConstants.TAG_NAMES.SCRIPT:\n        case _HelmetConstants.TAG_NAMES.NOSCRIPT:\n          return {\n            innerHTML: nestedChildren\n          };\n\n        case _HelmetConstants.TAG_NAMES.STYLE:\n          return {\n            cssText: nestedChildren\n          };\n      }\n\n      throw new Error(\"<\" + child.type + \" /> elements are self-closing and can not contain children. Refer to our API for more information.\");\n    };\n\n    HelmetWrapper.prototype.flattenArrayTypeChildren = function flattenArrayTypeChildren(_ref) {\n      var _extends2;\n\n      var child = _ref.child,\n          arrayTypeChildren = _ref.arrayTypeChildren,\n          newChildProps = _ref.newChildProps,\n          nestedChildren = _ref.nestedChildren;\n      return _extends({}, arrayTypeChildren, (_extends2 = {}, _extends2[child.type] = [].concat(arrayTypeChildren[child.type] || [], [_extends({}, newChildProps, this.mapNestedChildrenToProps(child, nestedChildren))]), _extends2));\n    };\n\n    HelmetWrapper.prototype.mapObjectTypeChildren = function mapObjectTypeChildren(_ref2) {\n      var _extends3, _extends4;\n\n      var child = _ref2.child,\n          newProps = _ref2.newProps,\n          newChildProps = _ref2.newChildProps,\n          nestedChildren = _ref2.nestedChildren;\n\n      switch (child.type) {\n        case _HelmetConstants.TAG_NAMES.TITLE:\n          return _extends({}, newProps, (_extends3 = {}, _extends3[child.type] = nestedChildren, _extends3.titleAttributes = _extends({}, newChildProps), _extends3));\n\n        case _HelmetConstants.TAG_NAMES.BODY:\n          return _extends({}, newProps, {\n            bodyAttributes: _extends({}, newChildProps)\n          });\n\n        case _HelmetConstants.TAG_NAMES.HTML:\n          return _extends({}, newProps, {\n            htmlAttributes: _extends({}, newChildProps)\n          });\n      }\n\n      return _extends({}, newProps, (_extends4 = {}, _extends4[child.type] = _extends({}, newChildProps), _extends4));\n    };\n\n    HelmetWrapper.prototype.mapArrayTypeChildrenToProps = function mapArrayTypeChildrenToProps(arrayTypeChildren, newProps) {\n      var newFlattenedProps = _extends({}, newProps);\n\n      Object.keys(arrayTypeChildren).forEach(function (arrayChildName) {\n        var _extends5;\n\n        newFlattenedProps = _extends({}, newFlattenedProps, (_extends5 = {}, _extends5[arrayChildName] = arrayTypeChildren[arrayChildName], _extends5));\n      });\n      return newFlattenedProps;\n    };\n\n    HelmetWrapper.prototype.warnOnInvalidChildren = function warnOnInvalidChildren(child, nestedChildren) {\n      if (process.env.NODE_ENV !== \"production\") {\n        if (!_HelmetConstants.VALID_TAG_NAMES.some(function (name) {\n          return child.type === name;\n        })) {\n          if (typeof child.type === \"function\") {\n            return (0, _HelmetUtils.warn)(\"You may be attempting to nest <Helmet> components within each other, which is not allowed. Refer to our API for more information.\");\n          }\n\n          return (0, _HelmetUtils.warn)(\"Only elements types \" + _HelmetConstants.VALID_TAG_NAMES.join(\", \") + \" are allowed. Helmet does not support rendering <\" + child.type + \"> elements. Refer to our API for more information.\");\n        }\n\n        if (nestedChildren && typeof nestedChildren !== \"string\" && (!Array.isArray(nestedChildren) || nestedChildren.some(function (nestedChild) {\n          return typeof nestedChild !== \"string\";\n        }))) {\n          throw new Error(\"Helmet expects a string as a child of <\" + child.type + \">. Did you forget to wrap your children in braces? ( <\" + child.type + \">{``}</\" + child.type + \"> ) Refer to our API for more information.\");\n        }\n      }\n\n      return true;\n    };\n\n    HelmetWrapper.prototype.mapChildrenToProps = function mapChildrenToProps(children, newProps) {\n      var _this2 = this;\n\n      var arrayTypeChildren = {};\n\n      _react2.default.Children.forEach(children, function (child) {\n        if (!child || !child.props) {\n          return;\n        }\n\n        var _child$props = child.props,\n            nestedChildren = _child$props.children,\n            childProps = _objectWithoutProperties(_child$props, [\"children\"]);\n\n        var newChildProps = (0, _HelmetUtils.convertReactPropstoHtmlAttributes)(childProps);\n\n        _this2.warnOnInvalidChildren(child, nestedChildren);\n\n        switch (child.type) {\n          case _HelmetConstants.TAG_NAMES.LINK:\n          case _HelmetConstants.TAG_NAMES.META:\n          case _HelmetConstants.TAG_NAMES.NOSCRIPT:\n          case _HelmetConstants.TAG_NAMES.SCRIPT:\n          case _HelmetConstants.TAG_NAMES.STYLE:\n            arrayTypeChildren = _this2.flattenArrayTypeChildren({\n              child: child,\n              arrayTypeChildren: arrayTypeChildren,\n              newChildProps: newChildProps,\n              nestedChildren: nestedChildren\n            });\n            break;\n\n          default:\n            newProps = _this2.mapObjectTypeChildren({\n              child: child,\n              newProps: newProps,\n              newChildProps: newChildProps,\n              nestedChildren: nestedChildren\n            });\n            break;\n        }\n      });\n\n      newProps = this.mapArrayTypeChildrenToProps(arrayTypeChildren, newProps);\n      return newProps;\n    };\n\n    HelmetWrapper.prototype.render = function render() {\n      var _props = this.props,\n          children = _props.children,\n          props = _objectWithoutProperties(_props, [\"children\"]);\n\n      var newProps = _extends({}, props);\n\n      if (children) {\n        newProps = this.mapChildrenToProps(children, newProps);\n      }\n\n      return _react2.default.createElement(Component, newProps);\n    };\n\n    _createClass(HelmetWrapper, null, [{\n      key: \"canUseDOM\",\n      // Component.peek comes from react-side-effect:\n      // For testing, you may use a static peek() method available on the returned component.\n      // It lets you get the current state without resetting the mounted instance stack.\n      // Dont use it for anything other than testing.\n\n      /**\n       * @param {Object} base: {\"target\": \"_blank\", \"href\": \"http://mysite.com/\"}\n       * @param {Object} bodyAttributes: {\"className\": \"root\"}\n       * @param {String} defaultTitle: \"Default Title\"\n       * @param {Boolean} defer: true\n       * @param {Boolean} encodeSpecialCharacters: true\n       * @param {Object} htmlAttributes: {\"lang\": \"en\", \"amp\": undefined}\n       * @param {Array} link: [{\"rel\": \"canonical\", \"href\": \"http://mysite.com/example\"}]\n       * @param {Array} meta: [{\"name\": \"description\", \"content\": \"Test description\"}]\n       * @param {Array} noscript: [{\"innerHTML\": \"<img src='http://mysite.com/js/test.js'\"}]\n       * @param {Function} onChangeClientState: \"(newState) => console.log(newState)\"\n       * @param {Array} script: [{\"type\": \"text/javascript\", \"src\": \"http://mysite.com/js/test.js\"}]\n       * @param {Array} style: [{\"type\": \"text/css\", \"cssText\": \"div { display: block; color: blue; }\"}]\n       * @param {String} title: \"Title\"\n       * @param {Object} titleAttributes: {\"itemprop\": \"name\"}\n       * @param {String} titleTemplate: \"MySite.com - %s\"\n       */\n      set: function set(canUseDOM) {\n        Component.canUseDOM = canUseDOM;\n      }\n    }]);\n\n    return HelmetWrapper;\n  }(_react2.default.Component), _class.propTypes = {\n    base: _propTypes2.default.object,\n    bodyAttributes: _propTypes2.default.object,\n    children: _propTypes2.default.oneOfType([_propTypes2.default.arrayOf(_propTypes2.default.node), _propTypes2.default.node]),\n    defaultTitle: _propTypes2.default.string,\n    defer: _propTypes2.default.bool,\n    encodeSpecialCharacters: _propTypes2.default.bool,\n    htmlAttributes: _propTypes2.default.object,\n    link: _propTypes2.default.arrayOf(_propTypes2.default.object),\n    meta: _propTypes2.default.arrayOf(_propTypes2.default.object),\n    noscript: _propTypes2.default.arrayOf(_propTypes2.default.object),\n    onChangeClientState: _propTypes2.default.func,\n    script: _propTypes2.default.arrayOf(_propTypes2.default.object),\n    style: _propTypes2.default.arrayOf(_propTypes2.default.object),\n    title: _propTypes2.default.string,\n    titleAttributes: _propTypes2.default.object,\n    titleTemplate: _propTypes2.default.string\n  }, _class.defaultProps = {\n    defer: true,\n    encodeSpecialCharacters: true\n  }, _class.peek = Component.peek, _class.rewind = function () {\n    var mappedState = Component.rewind();\n\n    if (!mappedState) {\n      // provide fallback if mappedState is undefined\n      mappedState = (0, _HelmetUtils.mapStateOnServer)({\n        baseTag: [],\n        bodyAttributes: {},\n        encodeSpecialCharacters: true,\n        htmlAttributes: {},\n        linkTags: [],\n        metaTags: [],\n        noscriptTags: [],\n        scriptTags: [],\n        styleTags: [],\n        title: \"\",\n        titleAttributes: {}\n      });\n    }\n\n    return mappedState;\n  }, _temp;\n};\n\nvar NullComponent = function NullComponent() {\n  return null;\n};\n\nvar HelmetSideEffects = (0, _reactSideEffect2.default)(_HelmetUtils.reducePropsToState, _HelmetUtils.handleClientStateChange, _HelmetUtils.mapStateOnServer)(NullComponent);\nvar HelmetExport = Helmet(HelmetSideEffects);\nHelmetExport.renderStatic = HelmetExport.rewind;\nexports.Helmet = HelmetExport;\nexports.default = HelmetExport;","/* eslint-disable jsx-a11y/anchor-is-valid */\nimport React from 'react';\nimport { Link } from 'gatsby';\n\nconst Header = () => (\n  <nav className=\"w-full flex items-center justify-between bg-blue-700 p-6\">\n    <div className=\"items-center w-1/2 text-white mr-6 text-center\">\n      <span className=\"font-semibold text-xl\">Gatsby Firebase Auth</span>\n    </div>\n    <div className=\"w-1/2 mt-1 text-md flex flex-row-reverse\">\n      <Link to=\"/app/profile\">\n        <a className=\"block text-white hover:text-grey-500 mr-4\">Profile</a>\n      </Link>\n      <Link to=\"/\">\n        <a className=\"block text-white hover:text-grey-500 mr-4\">Home</a>\n      </Link>\n    </div>\n  </nav>\n);\n\nexport default Header;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport { Helmet } from 'react-helmet';\n\nimport Header from '../Header';\n\n// Global styles and component-specific styles.\nimport './global.css';\nimport styles from './main.module.css';\n\nconst Layout = ({ children }) => (\n  <div>\n    <Helmet title=\"Gatsby Simple Firebase Authentication\" />\n    <Header />\n    <main className={styles.main}>{children}</main>\n  </div>\n);\n\nLayout.propTypes = {\n  children: PropTypes.node.isRequired\n};\n\nexport default Layout;\n","'use strict';\n\nvar isArray = Array.isArray;\nvar keyList = Object.keys;\nvar hasProp = Object.prototype.hasOwnProperty;\nvar hasElementType = typeof Element !== 'undefined';\n\nfunction equal(a, b) {\n  // fast-deep-equal index.js 2.0.1\n  if (a === b) return true;\n\n  if (a && b && typeof a == 'object' && typeof b == 'object') {\n    var arrA = isArray(a),\n        arrB = isArray(b),\n        i,\n        length,\n        key;\n\n    if (arrA && arrB) {\n      length = a.length;\n      if (length != b.length) return false;\n\n      for (i = length; i-- !== 0;) {\n        if (!equal(a[i], b[i])) return false;\n      }\n\n      return true;\n    }\n\n    if (arrA != arrB) return false;\n    var dateA = a instanceof Date,\n        dateB = b instanceof Date;\n    if (dateA != dateB) return false;\n    if (dateA && dateB) return a.getTime() == b.getTime();\n    var regexpA = a instanceof RegExp,\n        regexpB = b instanceof RegExp;\n    if (regexpA != regexpB) return false;\n    if (regexpA && regexpB) return a.toString() == b.toString();\n    var keys = keyList(a);\n    length = keys.length;\n    if (length !== keyList(b).length) return false;\n\n    for (i = length; i-- !== 0;) {\n      if (!hasProp.call(b, keys[i])) return false;\n    } // end fast-deep-equal\n    // start react-fast-compare\n    // custom handling for DOM elements\n\n\n    if (hasElementType && a instanceof Element && b instanceof Element) return a === b; // custom handling for React\n\n    for (i = length; i-- !== 0;) {\n      key = keys[i];\n\n      if (key === '_owner' && a.$$typeof) {\n        // React-specific: avoid traversing React elements' _owner.\n        //  _owner contains circular references\n        // and is not needed when comparing the actual elements (and not their owners)\n        // .$$typeof and ._store on just reasonable markers of a react element\n        continue;\n      } else {\n        // all other properties should be traversed as usual\n        if (!equal(a[key], b[key])) return false;\n      }\n    } // end react-fast-compare\n    // fast-deep-equal index.js 2.0.1\n\n\n    return true;\n  }\n\n  return a !== a && b !== b;\n} // end fast-deep-equal\n\n\nmodule.exports = function exportedEqual(a, b) {\n  try {\n    return equal(a, b);\n  } catch (error) {\n    if (error.message && error.message.match(/stack|recursion/i) || error.number === -2146828260) {\n      // warn on circular references, don't crash\n      // browsers give this different errors name and messages:\n      // chrome/safari: \"RangeError\", \"Maximum call stack size exceeded\"\n      // firefox: \"InternalError\", too much recursion\"\n      // edge: \"Error\", \"Out of stack space\"\n      console.warn('Warning: react-fast-compare does not handle circular references.', error.name, error.message);\n      return false;\n    } // some other error. we should definitely know about these\n\n\n    throw error;\n  }\n};","import firebase from '@firebase/app';\nimport { Component } from '@firebase/component';\nimport { __awaiter, __generator, __spread, __values, __assign } from 'tslib';\nimport { ErrorFactory, FirebaseError } from '@firebase/util';\nimport { openDb } from 'idb';\nvar name = \"@firebase/installations\";\nvar version = \"0.4.19\";\n/**\r\n * @license\r\n * Copyright 2019 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\n\nvar PENDING_TIMEOUT_MS = 10000;\nvar PACKAGE_VERSION = \"w:\" + version;\nvar INTERNAL_AUTH_VERSION = 'FIS_v2';\nvar INSTALLATIONS_API_URL = 'https://firebaseinstallations.googleapis.com/v1';\nvar TOKEN_EXPIRATION_BUFFER = 60 * 60 * 1000; // One hour\n\nvar SERVICE = 'installations';\nvar SERVICE_NAME = 'Installations';\n/**\r\n * @license\r\n * Copyright 2019 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\n\nvar _a;\n\nvar ERROR_DESCRIPTION_MAP = (_a = {}, _a[\"missing-app-config-values\"\n/* MISSING_APP_CONFIG_VALUES */\n] = 'Missing App configuration value: \"{$valueName}\"', _a[\"not-registered\"\n/* NOT_REGISTERED */\n] = 'Firebase Installation is not registered.', _a[\"installation-not-found\"\n/* INSTALLATION_NOT_FOUND */\n] = 'Firebase Installation not found.', _a[\"request-failed\"\n/* REQUEST_FAILED */\n] = '{$requestName} request failed with error \"{$serverCode} {$serverStatus}: {$serverMessage}\"', _a[\"app-offline\"\n/* APP_OFFLINE */\n] = 'Could not process request. Application offline.', _a[\"delete-pending-registration\"\n/* DELETE_PENDING_REGISTRATION */\n] = \"Can't delete installation while there is a pending registration request.\", _a);\nvar ERROR_FACTORY = new ErrorFactory(SERVICE, SERVICE_NAME, ERROR_DESCRIPTION_MAP);\n/** Returns true if error is a FirebaseError that is based on an error from the server. */\n\nfunction isServerError(error) {\n  return error instanceof FirebaseError && error.code.includes(\"request-failed\"\n  /* REQUEST_FAILED */\n  );\n}\n/**\r\n * @license\r\n * Copyright 2019 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\n\n\nfunction getInstallationsEndpoint(_a) {\n  var projectId = _a.projectId;\n  return INSTALLATIONS_API_URL + \"/projects/\" + projectId + \"/installations\";\n}\n\nfunction extractAuthTokenInfoFromResponse(response) {\n  return {\n    token: response.token,\n    requestStatus: 2\n    /* COMPLETED */\n    ,\n    expiresIn: getExpiresInFromResponseExpiresIn(response.expiresIn),\n    creationTime: Date.now()\n  };\n}\n\nfunction getErrorFromResponse(requestName, response) {\n  return __awaiter(this, void 0, void 0, function () {\n    var responseJson, errorData;\n    return __generator(this, function (_a) {\n      switch (_a.label) {\n        case 0:\n          return [4\n          /*yield*/\n          , response.json()];\n\n        case 1:\n          responseJson = _a.sent();\n          errorData = responseJson.error;\n          return [2\n          /*return*/\n          , ERROR_FACTORY.create(\"request-failed\"\n          /* REQUEST_FAILED */\n          , {\n            requestName: requestName,\n            serverCode: errorData.code,\n            serverMessage: errorData.message,\n            serverStatus: errorData.status\n          })];\n      }\n    });\n  });\n}\n\nfunction getHeaders(_a) {\n  var apiKey = _a.apiKey;\n  return new Headers({\n    'Content-Type': 'application/json',\n    Accept: 'application/json',\n    'x-goog-api-key': apiKey\n  });\n}\n\nfunction getHeadersWithAuth(appConfig, _a) {\n  var refreshToken = _a.refreshToken;\n  var headers = getHeaders(appConfig);\n  headers.append('Authorization', getAuthorizationHeader(refreshToken));\n  return headers;\n}\n/**\r\n * Calls the passed in fetch wrapper and returns the response.\r\n * If the returned response has a status of 5xx, re-runs the function once and\r\n * returns the response.\r\n */\n\n\nfunction retryIfServerError(fn) {\n  return __awaiter(this, void 0, void 0, function () {\n    var result;\n    return __generator(this, function (_a) {\n      switch (_a.label) {\n        case 0:\n          return [4\n          /*yield*/\n          , fn()];\n\n        case 1:\n          result = _a.sent();\n\n          if (result.status >= 500 && result.status < 600) {\n            // Internal Server Error. Retry request.\n            return [2\n            /*return*/\n            , fn()];\n          }\n\n          return [2\n          /*return*/\n          , result];\n      }\n    });\n  });\n}\n\nfunction getExpiresInFromResponseExpiresIn(responseExpiresIn) {\n  // This works because the server will never respond with fractions of a second.\n  return Number(responseExpiresIn.replace('s', '000'));\n}\n\nfunction getAuthorizationHeader(refreshToken) {\n  return INTERNAL_AUTH_VERSION + \" \" + refreshToken;\n}\n/**\r\n * @license\r\n * Copyright 2019 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\n\n\nfunction createInstallationRequest(appConfig, _a) {\n  var fid = _a.fid;\n  return __awaiter(this, void 0, void 0, function () {\n    var endpoint, headers, body, request, response, responseValue, registeredInstallationEntry;\n    return __generator(this, function (_b) {\n      switch (_b.label) {\n        case 0:\n          endpoint = getInstallationsEndpoint(appConfig);\n          headers = getHeaders(appConfig);\n          body = {\n            fid: fid,\n            authVersion: INTERNAL_AUTH_VERSION,\n            appId: appConfig.appId,\n            sdkVersion: PACKAGE_VERSION\n          };\n          request = {\n            method: 'POST',\n            headers: headers,\n            body: JSON.stringify(body)\n          };\n          return [4\n          /*yield*/\n          , retryIfServerError(function () {\n            return fetch(endpoint, request);\n          })];\n\n        case 1:\n          response = _b.sent();\n          if (!response.ok) return [3\n          /*break*/\n          , 3];\n          return [4\n          /*yield*/\n          , response.json()];\n\n        case 2:\n          responseValue = _b.sent();\n          registeredInstallationEntry = {\n            fid: responseValue.fid || fid,\n            registrationStatus: 2\n            /* COMPLETED */\n            ,\n            refreshToken: responseValue.refreshToken,\n            authToken: extractAuthTokenInfoFromResponse(responseValue.authToken)\n          };\n          return [2\n          /*return*/\n          , registeredInstallationEntry];\n\n        case 3:\n          return [4\n          /*yield*/\n          , getErrorFromResponse('Create Installation', response)];\n\n        case 4:\n          throw _b.sent();\n      }\n    });\n  });\n}\n/**\r\n * @license\r\n * Copyright 2019 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\n\n/** Returns a promise that resolves after given time passes. */\n\n\nfunction sleep(ms) {\n  return new Promise(function (resolve) {\n    setTimeout(resolve, ms);\n  });\n}\n/**\r\n * @license\r\n * Copyright 2019 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\n\n\nfunction bufferToBase64UrlSafe(array) {\n  var b64 = btoa(String.fromCharCode.apply(String, __spread(array)));\n  return b64.replace(/\\+/g, '-').replace(/\\//g, '_');\n}\n/**\r\n * @license\r\n * Copyright 2019 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\n\n\nvar VALID_FID_PATTERN = /^[cdef][\\w-]{21}$/;\nvar INVALID_FID = '';\n/**\r\n * Generates a new FID using random values from Web Crypto API.\r\n * Returns an empty string if FID generation fails for any reason.\r\n */\n\nfunction generateFid() {\n  try {\n    // A valid FID has exactly 22 base64 characters, which is 132 bits, or 16.5\n    // bytes. our implementation generates a 17 byte array instead.\n    var fidByteArray = new Uint8Array(17);\n    var crypto_1 = self.crypto || self.msCrypto;\n    crypto_1.getRandomValues(fidByteArray); // Replace the first 4 random bits with the constant FID header of 0b0111.\n\n    fidByteArray[0] = 112 + fidByteArray[0] % 16;\n    var fid = encode(fidByteArray);\n    return VALID_FID_PATTERN.test(fid) ? fid : INVALID_FID;\n  } catch (_a) {\n    // FID generation errored\n    return INVALID_FID;\n  }\n}\n/** Converts a FID Uint8Array to a base64 string representation. */\n\n\nfunction encode(fidByteArray) {\n  var b64String = bufferToBase64UrlSafe(fidByteArray); // Remove the 23rd character that was added because of the extra 4 bits at the\n  // end of our 17 byte array, and the '=' padding.\n\n  return b64String.substr(0, 22);\n}\n/**\r\n * @license\r\n * Copyright 2019 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\n\n/** Returns a string key that can be used to identify the app. */\n\n\nfunction getKey(appConfig) {\n  return appConfig.appName + \"!\" + appConfig.appId;\n}\n/**\r\n * @license\r\n * Copyright 2019 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\n\n\nvar fidChangeCallbacks = new Map();\n/**\r\n * Calls the onIdChange callbacks with the new FID value, and broadcasts the\r\n * change to other tabs.\r\n */\n\nfunction fidChanged(appConfig, fid) {\n  var key = getKey(appConfig);\n  callFidChangeCallbacks(key, fid);\n  broadcastFidChange(key, fid);\n}\n\nfunction addCallback(appConfig, callback) {\n  // Open the broadcast channel if it's not already open,\n  // to be able to listen to change events from other tabs.\n  getBroadcastChannel();\n  var key = getKey(appConfig);\n  var callbackSet = fidChangeCallbacks.get(key);\n\n  if (!callbackSet) {\n    callbackSet = new Set();\n    fidChangeCallbacks.set(key, callbackSet);\n  }\n\n  callbackSet.add(callback);\n}\n\nfunction removeCallback(appConfig, callback) {\n  var key = getKey(appConfig);\n  var callbackSet = fidChangeCallbacks.get(key);\n\n  if (!callbackSet) {\n    return;\n  }\n\n  callbackSet.delete(callback);\n\n  if (callbackSet.size === 0) {\n    fidChangeCallbacks.delete(key);\n  } // Close broadcast channel if there are no more callbacks.\n\n\n  closeBroadcastChannel();\n}\n\nfunction callFidChangeCallbacks(key, fid) {\n  var e_1, _a;\n\n  var callbacks = fidChangeCallbacks.get(key);\n\n  if (!callbacks) {\n    return;\n  }\n\n  try {\n    for (var callbacks_1 = __values(callbacks), callbacks_1_1 = callbacks_1.next(); !callbacks_1_1.done; callbacks_1_1 = callbacks_1.next()) {\n      var callback = callbacks_1_1.value;\n      callback(fid);\n    }\n  } catch (e_1_1) {\n    e_1 = {\n      error: e_1_1\n    };\n  } finally {\n    try {\n      if (callbacks_1_1 && !callbacks_1_1.done && (_a = callbacks_1.return)) _a.call(callbacks_1);\n    } finally {\n      if (e_1) throw e_1.error;\n    }\n  }\n}\n\nfunction broadcastFidChange(key, fid) {\n  var channel = getBroadcastChannel();\n\n  if (channel) {\n    channel.postMessage({\n      key: key,\n      fid: fid\n    });\n  }\n\n  closeBroadcastChannel();\n}\n\nvar broadcastChannel = null;\n/** Opens and returns a BroadcastChannel if it is supported by the browser. */\n\nfunction getBroadcastChannel() {\n  if (!broadcastChannel && 'BroadcastChannel' in self) {\n    broadcastChannel = new BroadcastChannel('[Firebase] FID Change');\n\n    broadcastChannel.onmessage = function (e) {\n      callFidChangeCallbacks(e.data.key, e.data.fid);\n    };\n  }\n\n  return broadcastChannel;\n}\n\nfunction closeBroadcastChannel() {\n  if (fidChangeCallbacks.size === 0 && broadcastChannel) {\n    broadcastChannel.close();\n    broadcastChannel = null;\n  }\n}\n/**\r\n * @license\r\n * Copyright 2019 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\n\n\nvar DATABASE_NAME = 'firebase-installations-database';\nvar DATABASE_VERSION = 1;\nvar OBJECT_STORE_NAME = 'firebase-installations-store';\nvar dbPromise = null;\n\nfunction getDbPromise() {\n  if (!dbPromise) {\n    dbPromise = openDb(DATABASE_NAME, DATABASE_VERSION, function (upgradeDB) {\n      // We don't use 'break' in this switch statement, the fall-through\n      // behavior is what we want, because if there are multiple versions between\n      // the old version and the current version, we want ALL the migrations\n      // that correspond to those versions to run, not only the last one.\n      // eslint-disable-next-line default-case\n      switch (upgradeDB.oldVersion) {\n        case 0:\n          upgradeDB.createObjectStore(OBJECT_STORE_NAME);\n      }\n    });\n  }\n\n  return dbPromise;\n}\n/** Assigns or overwrites the record for the given key with the given value. */\n\n\nfunction set(appConfig, value) {\n  return __awaiter(this, void 0, void 0, function () {\n    var key, db, tx, objectStore, oldValue;\n    return __generator(this, function (_a) {\n      switch (_a.label) {\n        case 0:\n          key = getKey(appConfig);\n          return [4\n          /*yield*/\n          , getDbPromise()];\n\n        case 1:\n          db = _a.sent();\n          tx = db.transaction(OBJECT_STORE_NAME, 'readwrite');\n          objectStore = tx.objectStore(OBJECT_STORE_NAME);\n          return [4\n          /*yield*/\n          , objectStore.get(key)];\n\n        case 2:\n          oldValue = _a.sent();\n          return [4\n          /*yield*/\n          , objectStore.put(value, key)];\n\n        case 3:\n          _a.sent();\n\n          return [4\n          /*yield*/\n          , tx.complete];\n\n        case 4:\n          _a.sent();\n\n          if (!oldValue || oldValue.fid !== value.fid) {\n            fidChanged(appConfig, value.fid);\n          }\n\n          return [2\n          /*return*/\n          , value];\n      }\n    });\n  });\n}\n/** Removes record(s) from the objectStore that match the given key. */\n\n\nfunction remove(appConfig) {\n  return __awaiter(this, void 0, void 0, function () {\n    var key, db, tx;\n    return __generator(this, function (_a) {\n      switch (_a.label) {\n        case 0:\n          key = getKey(appConfig);\n          return [4\n          /*yield*/\n          , getDbPromise()];\n\n        case 1:\n          db = _a.sent();\n          tx = db.transaction(OBJECT_STORE_NAME, 'readwrite');\n          return [4\n          /*yield*/\n          , tx.objectStore(OBJECT_STORE_NAME).delete(key)];\n\n        case 2:\n          _a.sent();\n\n          return [4\n          /*yield*/\n          , tx.complete];\n\n        case 3:\n          _a.sent();\n\n          return [2\n          /*return*/\n          ];\n      }\n    });\n  });\n}\n/**\r\n * Atomically updates a record with the result of updateFn, which gets\r\n * called with the current value. If newValue is undefined, the record is\r\n * deleted instead.\r\n * @return Updated value\r\n */\n\n\nfunction update(appConfig, updateFn) {\n  return __awaiter(this, void 0, void 0, function () {\n    var key, db, tx, store, oldValue, newValue;\n    return __generator(this, function (_a) {\n      switch (_a.label) {\n        case 0:\n          key = getKey(appConfig);\n          return [4\n          /*yield*/\n          , getDbPromise()];\n\n        case 1:\n          db = _a.sent();\n          tx = db.transaction(OBJECT_STORE_NAME, 'readwrite');\n          store = tx.objectStore(OBJECT_STORE_NAME);\n          return [4\n          /*yield*/\n          , store.get(key)];\n\n        case 2:\n          oldValue = _a.sent();\n          newValue = updateFn(oldValue);\n          if (!(newValue === undefined)) return [3\n          /*break*/\n          , 4];\n          return [4\n          /*yield*/\n          , store.delete(key)];\n\n        case 3:\n          _a.sent();\n\n          return [3\n          /*break*/\n          , 6];\n\n        case 4:\n          return [4\n          /*yield*/\n          , store.put(newValue, key)];\n\n        case 5:\n          _a.sent();\n\n          _a.label = 6;\n\n        case 6:\n          return [4\n          /*yield*/\n          , tx.complete];\n\n        case 7:\n          _a.sent();\n\n          if (newValue && (!oldValue || oldValue.fid !== newValue.fid)) {\n            fidChanged(appConfig, newValue.fid);\n          }\n\n          return [2\n          /*return*/\n          , newValue];\n      }\n    });\n  });\n}\n/**\r\n * @license\r\n * Copyright 2019 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\n\n/**\r\n * Updates and returns the InstallationEntry from the database.\r\n * Also triggers a registration request if it is necessary and possible.\r\n */\n\n\nfunction getInstallationEntry(appConfig) {\n  return __awaiter(this, void 0, void 0, function () {\n    var registrationPromise, installationEntry;\n\n    var _a;\n\n    return __generator(this, function (_b) {\n      switch (_b.label) {\n        case 0:\n          return [4\n          /*yield*/\n          , update(appConfig, function (oldEntry) {\n            var installationEntry = updateOrCreateInstallationEntry(oldEntry);\n            var entryWithPromise = triggerRegistrationIfNecessary(appConfig, installationEntry);\n            registrationPromise = entryWithPromise.registrationPromise;\n            return entryWithPromise.installationEntry;\n          })];\n\n        case 1:\n          installationEntry = _b.sent();\n          if (!(installationEntry.fid === INVALID_FID)) return [3\n          /*break*/\n          , 3];\n          _a = {};\n          return [4\n          /*yield*/\n          , registrationPromise];\n\n        case 2:\n          // FID generation failed. Waiting for the FID from the server.\n          return [2\n          /*return*/\n          , (_a.installationEntry = _b.sent(), _a)];\n\n        case 3:\n          return [2\n          /*return*/\n          , {\n            installationEntry: installationEntry,\n            registrationPromise: registrationPromise\n          }];\n      }\n    });\n  });\n}\n/**\r\n * Creates a new Installation Entry if one does not exist.\r\n * Also clears timed out pending requests.\r\n */\n\n\nfunction updateOrCreateInstallationEntry(oldEntry) {\n  var entry = oldEntry || {\n    fid: generateFid(),\n    registrationStatus: 0\n    /* NOT_STARTED */\n\n  };\n  return clearTimedOutRequest(entry);\n}\n/**\r\n * If the Firebase Installation is not registered yet, this will trigger the\r\n * registration and return an InProgressInstallationEntry.\r\n *\r\n * If registrationPromise does not exist, the installationEntry is guaranteed\r\n * to be registered.\r\n */\n\n\nfunction triggerRegistrationIfNecessary(appConfig, installationEntry) {\n  if (installationEntry.registrationStatus === 0\n  /* NOT_STARTED */\n  ) {\n      if (!navigator.onLine) {\n        // Registration required but app is offline.\n        var registrationPromiseWithError = Promise.reject(ERROR_FACTORY.create(\"app-offline\"\n        /* APP_OFFLINE */\n        ));\n        return {\n          installationEntry: installationEntry,\n          registrationPromise: registrationPromiseWithError\n        };\n      } // Try registering. Change status to IN_PROGRESS.\n\n\n      var inProgressEntry = {\n        fid: installationEntry.fid,\n        registrationStatus: 1\n        /* IN_PROGRESS */\n        ,\n        registrationTime: Date.now()\n      };\n      var registrationPromise = registerInstallation(appConfig, inProgressEntry);\n      return {\n        installationEntry: inProgressEntry,\n        registrationPromise: registrationPromise\n      };\n    } else if (installationEntry.registrationStatus === 1\n  /* IN_PROGRESS */\n  ) {\n      return {\n        installationEntry: installationEntry,\n        registrationPromise: waitUntilFidRegistration(appConfig)\n      };\n    } else {\n    return {\n      installationEntry: installationEntry\n    };\n  }\n}\n/** This will be executed only once for each new Firebase Installation. */\n\n\nfunction registerInstallation(appConfig, installationEntry) {\n  return __awaiter(this, void 0, void 0, function () {\n    var registeredInstallationEntry, e_1;\n    return __generator(this, function (_a) {\n      switch (_a.label) {\n        case 0:\n          _a.trys.push([0, 2,, 7]);\n\n          return [4\n          /*yield*/\n          , createInstallationRequest(appConfig, installationEntry)];\n\n        case 1:\n          registeredInstallationEntry = _a.sent();\n          return [2\n          /*return*/\n          , set(appConfig, registeredInstallationEntry)];\n\n        case 2:\n          e_1 = _a.sent();\n          if (!(isServerError(e_1) && e_1.customData.serverCode === 409)) return [3\n          /*break*/\n          , 4]; // Server returned a \"FID can not be used\" error.\n          // Generate a new ID next time.\n\n          return [4\n          /*yield*/\n          , remove(appConfig)];\n\n        case 3:\n          // Server returned a \"FID can not be used\" error.\n          // Generate a new ID next time.\n          _a.sent();\n\n          return [3\n          /*break*/\n          , 6];\n\n        case 4:\n          // Registration failed. Set FID as not registered.\n          return [4\n          /*yield*/\n          , set(appConfig, {\n            fid: installationEntry.fid,\n            registrationStatus: 0\n            /* NOT_STARTED */\n\n          })];\n\n        case 5:\n          // Registration failed. Set FID as not registered.\n          _a.sent();\n\n          _a.label = 6;\n\n        case 6:\n          throw e_1;\n\n        case 7:\n          return [2\n          /*return*/\n          ];\n      }\n    });\n  });\n}\n/** Call if FID registration is pending in another request. */\n\n\nfunction waitUntilFidRegistration(appConfig) {\n  return __awaiter(this, void 0, void 0, function () {\n    var entry, _a, installationEntry, registrationPromise;\n\n    return __generator(this, function (_b) {\n      switch (_b.label) {\n        case 0:\n          return [4\n          /*yield*/\n          , updateInstallationRequest(appConfig)];\n\n        case 1:\n          entry = _b.sent();\n          _b.label = 2;\n\n        case 2:\n          if (!(entry.registrationStatus === 1\n          /* IN_PROGRESS */\n          )) return [3\n            /*break*/\n            , 5]; // createInstallation request still in progress.\n\n          return [4\n          /*yield*/\n          , sleep(100)];\n\n        case 3:\n          // createInstallation request still in progress.\n          _b.sent();\n\n          return [4\n          /*yield*/\n          , updateInstallationRequest(appConfig)];\n\n        case 4:\n          entry = _b.sent();\n          return [3\n          /*break*/\n          , 2];\n\n        case 5:\n          if (!(entry.registrationStatus === 0\n          /* NOT_STARTED */\n          )) return [3\n            /*break*/\n            , 7];\n          return [4\n          /*yield*/\n          , getInstallationEntry(appConfig)];\n\n        case 6:\n          _a = _b.sent(), installationEntry = _a.installationEntry, registrationPromise = _a.registrationPromise;\n\n          if (registrationPromise) {\n            return [2\n            /*return*/\n            , registrationPromise];\n          } else {\n            // if there is no registrationPromise, entry is registered.\n            return [2\n            /*return*/\n            , installationEntry];\n          }\n\n        case 7:\n          return [2\n          /*return*/\n          , entry];\n      }\n    });\n  });\n}\n/**\r\n * Called only if there is a CreateInstallation request in progress.\r\n *\r\n * Updates the InstallationEntry in the DB based on the status of the\r\n * CreateInstallation request.\r\n *\r\n * Returns the updated InstallationEntry.\r\n */\n\n\nfunction updateInstallationRequest(appConfig) {\n  return update(appConfig, function (oldEntry) {\n    if (!oldEntry) {\n      throw ERROR_FACTORY.create(\"installation-not-found\"\n      /* INSTALLATION_NOT_FOUND */\n      );\n    }\n\n    return clearTimedOutRequest(oldEntry);\n  });\n}\n\nfunction clearTimedOutRequest(entry) {\n  if (hasInstallationRequestTimedOut(entry)) {\n    return {\n      fid: entry.fid,\n      registrationStatus: 0\n      /* NOT_STARTED */\n\n    };\n  }\n\n  return entry;\n}\n\nfunction hasInstallationRequestTimedOut(installationEntry) {\n  return installationEntry.registrationStatus === 1\n  /* IN_PROGRESS */\n  && installationEntry.registrationTime + PENDING_TIMEOUT_MS < Date.now();\n}\n/**\r\n * @license\r\n * Copyright 2019 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\n\n\nfunction generateAuthTokenRequest(_a, installationEntry) {\n  var appConfig = _a.appConfig,\n      platformLoggerProvider = _a.platformLoggerProvider;\n  return __awaiter(this, void 0, void 0, function () {\n    var endpoint, headers, platformLogger, body, request, response, responseValue, completedAuthToken;\n    return __generator(this, function (_b) {\n      switch (_b.label) {\n        case 0:\n          endpoint = getGenerateAuthTokenEndpoint(appConfig, installationEntry);\n          headers = getHeadersWithAuth(appConfig, installationEntry);\n          platformLogger = platformLoggerProvider.getImmediate({\n            optional: true\n          });\n\n          if (platformLogger) {\n            headers.append('x-firebase-client', platformLogger.getPlatformInfoString());\n          }\n\n          body = {\n            installation: {\n              sdkVersion: PACKAGE_VERSION\n            }\n          };\n          request = {\n            method: 'POST',\n            headers: headers,\n            body: JSON.stringify(body)\n          };\n          return [4\n          /*yield*/\n          , retryIfServerError(function () {\n            return fetch(endpoint, request);\n          })];\n\n        case 1:\n          response = _b.sent();\n          if (!response.ok) return [3\n          /*break*/\n          , 3];\n          return [4\n          /*yield*/\n          , response.json()];\n\n        case 2:\n          responseValue = _b.sent();\n          completedAuthToken = extractAuthTokenInfoFromResponse(responseValue);\n          return [2\n          /*return*/\n          , completedAuthToken];\n\n        case 3:\n          return [4\n          /*yield*/\n          , getErrorFromResponse('Generate Auth Token', response)];\n\n        case 4:\n          throw _b.sent();\n      }\n    });\n  });\n}\n\nfunction getGenerateAuthTokenEndpoint(appConfig, _a) {\n  var fid = _a.fid;\n  return getInstallationsEndpoint(appConfig) + \"/\" + fid + \"/authTokens:generate\";\n}\n/**\r\n * @license\r\n * Copyright 2019 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\n\n/**\r\n * Returns a valid authentication token for the installation. Generates a new\r\n * token if one doesn't exist, is expired or about to expire.\r\n *\r\n * Should only be called if the Firebase Installation is registered.\r\n */\n\n\nfunction refreshAuthToken(dependencies, forceRefresh) {\n  if (forceRefresh === void 0) {\n    forceRefresh = false;\n  }\n\n  return __awaiter(this, void 0, void 0, function () {\n    var tokenPromise, entry, authToken, _a;\n\n    return __generator(this, function (_b) {\n      switch (_b.label) {\n        case 0:\n          return [4\n          /*yield*/\n          , update(dependencies.appConfig, function (oldEntry) {\n            if (!isEntryRegistered(oldEntry)) {\n              throw ERROR_FACTORY.create(\"not-registered\"\n              /* NOT_REGISTERED */\n              );\n            }\n\n            var oldAuthToken = oldEntry.authToken;\n\n            if (!forceRefresh && isAuthTokenValid(oldAuthToken)) {\n              // There is a valid token in the DB.\n              return oldEntry;\n            } else if (oldAuthToken.requestStatus === 1\n            /* IN_PROGRESS */\n            ) {\n                // There already is a token request in progress.\n                tokenPromise = waitUntilAuthTokenRequest(dependencies, forceRefresh);\n                return oldEntry;\n              } else {\n              // No token or token expired.\n              if (!navigator.onLine) {\n                throw ERROR_FACTORY.create(\"app-offline\"\n                /* APP_OFFLINE */\n                );\n              }\n\n              var inProgressEntry = makeAuthTokenRequestInProgressEntry(oldEntry);\n              tokenPromise = fetchAuthTokenFromServer(dependencies, inProgressEntry);\n              return inProgressEntry;\n            }\n          })];\n\n        case 1:\n          entry = _b.sent();\n          if (!tokenPromise) return [3\n          /*break*/\n          , 3];\n          return [4\n          /*yield*/\n          , tokenPromise];\n\n        case 2:\n          _a = _b.sent();\n          return [3\n          /*break*/\n          , 4];\n\n        case 3:\n          _a = entry.authToken;\n          _b.label = 4;\n\n        case 4:\n          authToken = _a;\n          return [2\n          /*return*/\n          , authToken];\n      }\n    });\n  });\n}\n/**\r\n * Call only if FID is registered and Auth Token request is in progress.\r\n *\r\n * Waits until the current pending request finishes. If the request times out,\r\n * tries once in this thread as well.\r\n */\n\n\nfunction waitUntilAuthTokenRequest(dependencies, forceRefresh) {\n  return __awaiter(this, void 0, void 0, function () {\n    var entry, authToken;\n    return __generator(this, function (_a) {\n      switch (_a.label) {\n        case 0:\n          return [4\n          /*yield*/\n          , updateAuthTokenRequest(dependencies.appConfig)];\n\n        case 1:\n          entry = _a.sent();\n          _a.label = 2;\n\n        case 2:\n          if (!(entry.authToken.requestStatus === 1\n          /* IN_PROGRESS */\n          )) return [3\n            /*break*/\n            , 5]; // generateAuthToken still in progress.\n\n          return [4\n          /*yield*/\n          , sleep(100)];\n\n        case 3:\n          // generateAuthToken still in progress.\n          _a.sent();\n\n          return [4\n          /*yield*/\n          , updateAuthTokenRequest(dependencies.appConfig)];\n\n        case 4:\n          entry = _a.sent();\n          return [3\n          /*break*/\n          , 2];\n\n        case 5:\n          authToken = entry.authToken;\n\n          if (authToken.requestStatus === 0\n          /* NOT_STARTED */\n          ) {\n              // The request timed out or failed in a different call. Try again.\n              return [2\n              /*return*/\n              , refreshAuthToken(dependencies, forceRefresh)];\n            } else {\n            return [2\n            /*return*/\n            , authToken];\n          }\n\n      }\n    });\n  });\n}\n/**\r\n * Called only if there is a GenerateAuthToken request in progress.\r\n *\r\n * Updates the InstallationEntry in the DB based on the status of the\r\n * GenerateAuthToken request.\r\n *\r\n * Returns the updated InstallationEntry.\r\n */\n\n\nfunction updateAuthTokenRequest(appConfig) {\n  return update(appConfig, function (oldEntry) {\n    if (!isEntryRegistered(oldEntry)) {\n      throw ERROR_FACTORY.create(\"not-registered\"\n      /* NOT_REGISTERED */\n      );\n    }\n\n    var oldAuthToken = oldEntry.authToken;\n\n    if (hasAuthTokenRequestTimedOut(oldAuthToken)) {\n      return __assign(__assign({}, oldEntry), {\n        authToken: {\n          requestStatus: 0\n          /* NOT_STARTED */\n\n        }\n      });\n    }\n\n    return oldEntry;\n  });\n}\n\nfunction fetchAuthTokenFromServer(dependencies, installationEntry) {\n  return __awaiter(this, void 0, void 0, function () {\n    var authToken, updatedInstallationEntry, e_1, updatedInstallationEntry;\n    return __generator(this, function (_a) {\n      switch (_a.label) {\n        case 0:\n          _a.trys.push([0, 3,, 8]);\n\n          return [4\n          /*yield*/\n          , generateAuthTokenRequest(dependencies, installationEntry)];\n\n        case 1:\n          authToken = _a.sent();\n          updatedInstallationEntry = __assign(__assign({}, installationEntry), {\n            authToken: authToken\n          });\n          return [4\n          /*yield*/\n          , set(dependencies.appConfig, updatedInstallationEntry)];\n\n        case 2:\n          _a.sent();\n\n          return [2\n          /*return*/\n          , authToken];\n\n        case 3:\n          e_1 = _a.sent();\n          if (!(isServerError(e_1) && (e_1.customData.serverCode === 401 || e_1.customData.serverCode === 404))) return [3\n          /*break*/\n          , 5]; // Server returned a \"FID not found\" or a \"Invalid authentication\" error.\n          // Generate a new ID next time.\n\n          return [4\n          /*yield*/\n          , remove(dependencies.appConfig)];\n\n        case 4:\n          // Server returned a \"FID not found\" or a \"Invalid authentication\" error.\n          // Generate a new ID next time.\n          _a.sent();\n\n          return [3\n          /*break*/\n          , 7];\n\n        case 5:\n          updatedInstallationEntry = __assign(__assign({}, installationEntry), {\n            authToken: {\n              requestStatus: 0\n              /* NOT_STARTED */\n\n            }\n          });\n          return [4\n          /*yield*/\n          , set(dependencies.appConfig, updatedInstallationEntry)];\n\n        case 6:\n          _a.sent();\n\n          _a.label = 7;\n\n        case 7:\n          throw e_1;\n\n        case 8:\n          return [2\n          /*return*/\n          ];\n      }\n    });\n  });\n}\n\nfunction isEntryRegistered(installationEntry) {\n  return installationEntry !== undefined && installationEntry.registrationStatus === 2\n  /* COMPLETED */\n  ;\n}\n\nfunction isAuthTokenValid(authToken) {\n  return authToken.requestStatus === 2\n  /* COMPLETED */\n  && !isAuthTokenExpired(authToken);\n}\n\nfunction isAuthTokenExpired(authToken) {\n  var now = Date.now();\n  return now < authToken.creationTime || authToken.creationTime + authToken.expiresIn < now + TOKEN_EXPIRATION_BUFFER;\n}\n/** Returns an updated InstallationEntry with an InProgressAuthToken. */\n\n\nfunction makeAuthTokenRequestInProgressEntry(oldEntry) {\n  var inProgressAuthToken = {\n    requestStatus: 1\n    /* IN_PROGRESS */\n    ,\n    requestTime: Date.now()\n  };\n  return __assign(__assign({}, oldEntry), {\n    authToken: inProgressAuthToken\n  });\n}\n\nfunction hasAuthTokenRequestTimedOut(authToken) {\n  return authToken.requestStatus === 1\n  /* IN_PROGRESS */\n  && authToken.requestTime + PENDING_TIMEOUT_MS < Date.now();\n}\n/**\r\n * @license\r\n * Copyright 2019 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\n\n\nfunction _getId(dependencies) {\n  return __awaiter(this, void 0, void 0, function () {\n    var _a, installationEntry, registrationPromise;\n\n    return __generator(this, function (_b) {\n      switch (_b.label) {\n        case 0:\n          return [4\n          /*yield*/\n          , getInstallationEntry(dependencies.appConfig)];\n\n        case 1:\n          _a = _b.sent(), installationEntry = _a.installationEntry, registrationPromise = _a.registrationPromise;\n\n          if (registrationPromise) {\n            registrationPromise.catch(console.error);\n          } else {\n            // If the installation is already registered, update the authentication\n            // token if needed.\n            refreshAuthToken(dependencies).catch(console.error);\n          }\n\n          return [2\n          /*return*/\n          , installationEntry.fid];\n      }\n    });\n  });\n}\n/**\r\n * @license\r\n * Copyright 2019 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\n\n\nfunction _getToken(dependencies, forceRefresh) {\n  if (forceRefresh === void 0) {\n    forceRefresh = false;\n  }\n\n  return __awaiter(this, void 0, void 0, function () {\n    var authToken;\n    return __generator(this, function (_a) {\n      switch (_a.label) {\n        case 0:\n          return [4\n          /*yield*/\n          , completeInstallationRegistration(dependencies.appConfig)];\n\n        case 1:\n          _a.sent();\n\n          return [4\n          /*yield*/\n          , refreshAuthToken(dependencies, forceRefresh)];\n\n        case 2:\n          authToken = _a.sent();\n          return [2\n          /*return*/\n          , authToken.token];\n      }\n    });\n  });\n}\n\nfunction completeInstallationRegistration(appConfig) {\n  return __awaiter(this, void 0, void 0, function () {\n    var registrationPromise;\n    return __generator(this, function (_a) {\n      switch (_a.label) {\n        case 0:\n          return [4\n          /*yield*/\n          , getInstallationEntry(appConfig)];\n\n        case 1:\n          registrationPromise = _a.sent().registrationPromise;\n          if (!registrationPromise) return [3\n          /*break*/\n          , 3]; // A createInstallation request is in progress. Wait until it finishes.\n\n          return [4\n          /*yield*/\n          , registrationPromise];\n\n        case 2:\n          // A createInstallation request is in progress. Wait until it finishes.\n          _a.sent();\n\n          _a.label = 3;\n\n        case 3:\n          return [2\n          /*return*/\n          ];\n      }\n    });\n  });\n}\n/**\r\n * @license\r\n * Copyright 2019 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\n\n\nfunction deleteInstallationRequest(appConfig, installationEntry) {\n  return __awaiter(this, void 0, void 0, function () {\n    var endpoint, headers, request, response;\n    return __generator(this, function (_a) {\n      switch (_a.label) {\n        case 0:\n          endpoint = getDeleteEndpoint(appConfig, installationEntry);\n          headers = getHeadersWithAuth(appConfig, installationEntry);\n          request = {\n            method: 'DELETE',\n            headers: headers\n          };\n          return [4\n          /*yield*/\n          , retryIfServerError(function () {\n            return fetch(endpoint, request);\n          })];\n\n        case 1:\n          response = _a.sent();\n          if (!!response.ok) return [3\n          /*break*/\n          , 3];\n          return [4\n          /*yield*/\n          , getErrorFromResponse('Delete Installation', response)];\n\n        case 2:\n          throw _a.sent();\n\n        case 3:\n          return [2\n          /*return*/\n          ];\n      }\n    });\n  });\n}\n\nfunction getDeleteEndpoint(appConfig, _a) {\n  var fid = _a.fid;\n  return getInstallationsEndpoint(appConfig) + \"/\" + fid;\n}\n/**\r\n * @license\r\n * Copyright 2019 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\n\n\nfunction deleteInstallation(dependencies) {\n  return __awaiter(this, void 0, void 0, function () {\n    var appConfig, entry;\n    return __generator(this, function (_a) {\n      switch (_a.label) {\n        case 0:\n          appConfig = dependencies.appConfig;\n          return [4\n          /*yield*/\n          , update(appConfig, function (oldEntry) {\n            if (oldEntry && oldEntry.registrationStatus === 0\n            /* NOT_STARTED */\n            ) {\n                // Delete the unregistered entry without sending a deleteInstallation request.\n                return undefined;\n              }\n\n            return oldEntry;\n          })];\n\n        case 1:\n          entry = _a.sent();\n          if (!entry) return [3\n          /*break*/\n          , 6];\n          if (!(entry.registrationStatus === 1\n          /* IN_PROGRESS */\n          )) return [3\n            /*break*/\n            , 2]; // Can't delete while trying to register.\n\n          throw ERROR_FACTORY.create(\"delete-pending-registration\"\n          /* DELETE_PENDING_REGISTRATION */\n          );\n\n        case 2:\n          if (!(entry.registrationStatus === 2\n          /* COMPLETED */\n          )) return [3\n            /*break*/\n            , 6];\n          if (!!navigator.onLine) return [3\n          /*break*/\n          , 3];\n          throw ERROR_FACTORY.create(\"app-offline\"\n          /* APP_OFFLINE */\n          );\n\n        case 3:\n          return [4\n          /*yield*/\n          , deleteInstallationRequest(appConfig, entry)];\n\n        case 4:\n          _a.sent();\n\n          return [4\n          /*yield*/\n          , remove(appConfig)];\n\n        case 5:\n          _a.sent();\n\n          _a.label = 6;\n\n        case 6:\n          return [2\n          /*return*/\n          ];\n      }\n    });\n  });\n}\n/**\r\n * @license\r\n * Copyright 2019 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\n\n/**\r\n * Sets a new callback that will get called when Installation ID changes.\r\n * Returns an unsubscribe function that will remove the callback when called.\r\n */\n\n\nfunction _onIdChange(_a, callback) {\n  var appConfig = _a.appConfig;\n  addCallback(appConfig, callback);\n  return function () {\n    removeCallback(appConfig, callback);\n  };\n}\n/**\r\n * @license\r\n * Copyright 2019 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\n\n\nfunction extractAppConfig(app) {\n  var e_1, _a;\n\n  if (!app || !app.options) {\n    throw getMissingValueError('App Configuration');\n  }\n\n  if (!app.name) {\n    throw getMissingValueError('App Name');\n  } // Required app config keys\n\n\n  var configKeys = ['projectId', 'apiKey', 'appId'];\n\n  try {\n    for (var configKeys_1 = __values(configKeys), configKeys_1_1 = configKeys_1.next(); !configKeys_1_1.done; configKeys_1_1 = configKeys_1.next()) {\n      var keyName = configKeys_1_1.value;\n\n      if (!app.options[keyName]) {\n        throw getMissingValueError(keyName);\n      }\n    }\n  } catch (e_1_1) {\n    e_1 = {\n      error: e_1_1\n    };\n  } finally {\n    try {\n      if (configKeys_1_1 && !configKeys_1_1.done && (_a = configKeys_1.return)) _a.call(configKeys_1);\n    } finally {\n      if (e_1) throw e_1.error;\n    }\n  }\n\n  return {\n    appName: app.name,\n    projectId: app.options.projectId,\n    apiKey: app.options.apiKey,\n    appId: app.options.appId\n  };\n}\n\nfunction getMissingValueError(valueName) {\n  return ERROR_FACTORY.create(\"missing-app-config-values\"\n  /* MISSING_APP_CONFIG_VALUES */\n  , {\n    valueName: valueName\n  });\n}\n/**\r\n * @license\r\n * Copyright 2019 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\n\n\nfunction registerInstallations(instance) {\n  var installationsName = 'installations';\n  instance.INTERNAL.registerComponent(new Component(installationsName, function (container) {\n    var app = container.getProvider('app').getImmediate(); // Throws if app isn't configured properly.\n\n    var appConfig = extractAppConfig(app);\n    var platformLoggerProvider = container.getProvider('platform-logger');\n    var dependencies = {\n      appConfig: appConfig,\n      platformLoggerProvider: platformLoggerProvider\n    };\n    var installations = {\n      app: app,\n      getId: function getId() {\n        return _getId(dependencies);\n      },\n      getToken: function getToken(forceRefresh) {\n        return _getToken(dependencies, forceRefresh);\n      },\n      delete: function _delete() {\n        return deleteInstallation(dependencies);\n      },\n      onIdChange: function onIdChange(callback) {\n        return _onIdChange(dependencies, callback);\n      }\n    };\n    return installations;\n  }, \"PUBLIC\"\n  /* PUBLIC */\n  ));\n  instance.registerVersion(name, version);\n}\n\nregisterInstallations(firebase);\nexport { registerInstallations };","require(\"core-js/modules/es.array.reduce\");\n\nexports.__esModule = true;\nvar ATTRIBUTE_NAMES = exports.ATTRIBUTE_NAMES = {\n  BODY: \"bodyAttributes\",\n  HTML: \"htmlAttributes\",\n  TITLE: \"titleAttributes\"\n};\nvar TAG_NAMES = exports.TAG_NAMES = {\n  BASE: \"base\",\n  BODY: \"body\",\n  HEAD: \"head\",\n  HTML: \"html\",\n  LINK: \"link\",\n  META: \"meta\",\n  NOSCRIPT: \"noscript\",\n  SCRIPT: \"script\",\n  STYLE: \"style\",\n  TITLE: \"title\"\n};\nvar VALID_TAG_NAMES = exports.VALID_TAG_NAMES = Object.keys(TAG_NAMES).map(function (name) {\n  return TAG_NAMES[name];\n});\nvar TAG_PROPERTIES = exports.TAG_PROPERTIES = {\n  CHARSET: \"charset\",\n  CSS_TEXT: \"cssText\",\n  HREF: \"href\",\n  HTTPEQUIV: \"http-equiv\",\n  INNER_HTML: \"innerHTML\",\n  ITEM_PROP: \"itemprop\",\n  NAME: \"name\",\n  PROPERTY: \"property\",\n  REL: \"rel\",\n  SRC: \"src\"\n};\nvar REACT_TAG_MAP = exports.REACT_TAG_MAP = {\n  accesskey: \"accessKey\",\n  charset: \"charSet\",\n  class: \"className\",\n  contenteditable: \"contentEditable\",\n  contextmenu: \"contextMenu\",\n  \"http-equiv\": \"httpEquiv\",\n  itemprop: \"itemProp\",\n  tabindex: \"tabIndex\"\n};\nvar HELMET_PROPS = exports.HELMET_PROPS = {\n  DEFAULT_TITLE: \"defaultTitle\",\n  DEFER: \"defer\",\n  ENCODE_SPECIAL_CHARACTERS: \"encodeSpecialCharacters\",\n  ON_CHANGE_CLIENT_STATE: \"onChangeClientState\",\n  TITLE_TEMPLATE: \"titleTemplate\"\n};\nvar HTML_TAG_MAP = exports.HTML_TAG_MAP = Object.keys(REACT_TAG_MAP).reduce(function (obj, key) {\n  obj[REACT_TAG_MAP[key]] = key;\n  return obj;\n}, {});\nvar SELF_CLOSING_TAGS = exports.SELF_CLOSING_TAGS = [TAG_NAMES.NOSCRIPT, TAG_NAMES.SCRIPT, TAG_NAMES.STYLE];\nvar HELMET_ATTRIBUTE = exports.HELMET_ATTRIBUTE = \"data-react-helmet\";","(function (global, factory) {\n  typeof exports === 'object' && typeof module !== 'undefined' ? factory(exports) : typeof define === 'function' && define.amd ? define(['exports'], factory) : (global = global || self, factory(global.idb = {}));\n})(this, function (exports) {\n  'use strict';\n\n  function toArray(arr) {\n    return Array.prototype.slice.call(arr);\n  }\n\n  function promisifyRequest(request) {\n    return new Promise(function (resolve, reject) {\n      request.onsuccess = function () {\n        resolve(request.result);\n      };\n\n      request.onerror = function () {\n        reject(request.error);\n      };\n    });\n  }\n\n  function promisifyRequestCall(obj, method, args) {\n    var request;\n    var p = new Promise(function (resolve, reject) {\n      request = obj[method].apply(obj, args);\n      promisifyRequest(request).then(resolve, reject);\n    });\n    p.request = request;\n    return p;\n  }\n\n  function promisifyCursorRequestCall(obj, method, args) {\n    var p = promisifyRequestCall(obj, method, args);\n    return p.then(function (value) {\n      if (!value) return;\n      return new Cursor(value, p.request);\n    });\n  }\n\n  function proxyProperties(ProxyClass, targetProp, properties) {\n    properties.forEach(function (prop) {\n      Object.defineProperty(ProxyClass.prototype, prop, {\n        get: function get() {\n          return this[targetProp][prop];\n        },\n        set: function set(val) {\n          this[targetProp][prop] = val;\n        }\n      });\n    });\n  }\n\n  function proxyRequestMethods(ProxyClass, targetProp, Constructor, properties) {\n    properties.forEach(function (prop) {\n      if (!(prop in Constructor.prototype)) return;\n\n      ProxyClass.prototype[prop] = function () {\n        return promisifyRequestCall(this[targetProp], prop, arguments);\n      };\n    });\n  }\n\n  function proxyMethods(ProxyClass, targetProp, Constructor, properties) {\n    properties.forEach(function (prop) {\n      if (!(prop in Constructor.prototype)) return;\n\n      ProxyClass.prototype[prop] = function () {\n        return this[targetProp][prop].apply(this[targetProp], arguments);\n      };\n    });\n  }\n\n  function proxyCursorRequestMethods(ProxyClass, targetProp, Constructor, properties) {\n    properties.forEach(function (prop) {\n      if (!(prop in Constructor.prototype)) return;\n\n      ProxyClass.prototype[prop] = function () {\n        return promisifyCursorRequestCall(this[targetProp], prop, arguments);\n      };\n    });\n  }\n\n  function Index(index) {\n    this._index = index;\n  }\n\n  proxyProperties(Index, '_index', ['name', 'keyPath', 'multiEntry', 'unique']);\n  proxyRequestMethods(Index, '_index', IDBIndex, ['get', 'getKey', 'getAll', 'getAllKeys', 'count']);\n  proxyCursorRequestMethods(Index, '_index', IDBIndex, ['openCursor', 'openKeyCursor']);\n\n  function Cursor(cursor, request) {\n    this._cursor = cursor;\n    this._request = request;\n  }\n\n  proxyProperties(Cursor, '_cursor', ['direction', 'key', 'primaryKey', 'value']);\n  proxyRequestMethods(Cursor, '_cursor', IDBCursor, ['update', 'delete']); // proxy 'next' methods\n\n  ['advance', 'continue', 'continuePrimaryKey'].forEach(function (methodName) {\n    if (!(methodName in IDBCursor.prototype)) return;\n\n    Cursor.prototype[methodName] = function () {\n      var cursor = this;\n      var args = arguments;\n      return Promise.resolve().then(function () {\n        cursor._cursor[methodName].apply(cursor._cursor, args);\n\n        return promisifyRequest(cursor._request).then(function (value) {\n          if (!value) return;\n          return new Cursor(value, cursor._request);\n        });\n      });\n    };\n  });\n\n  function ObjectStore(store) {\n    this._store = store;\n  }\n\n  ObjectStore.prototype.createIndex = function () {\n    return new Index(this._store.createIndex.apply(this._store, arguments));\n  };\n\n  ObjectStore.prototype.index = function () {\n    return new Index(this._store.index.apply(this._store, arguments));\n  };\n\n  proxyProperties(ObjectStore, '_store', ['name', 'keyPath', 'indexNames', 'autoIncrement']);\n  proxyRequestMethods(ObjectStore, '_store', IDBObjectStore, ['put', 'add', 'delete', 'clear', 'get', 'getAll', 'getKey', 'getAllKeys', 'count']);\n  proxyCursorRequestMethods(ObjectStore, '_store', IDBObjectStore, ['openCursor', 'openKeyCursor']);\n  proxyMethods(ObjectStore, '_store', IDBObjectStore, ['deleteIndex']);\n\n  function Transaction(idbTransaction) {\n    this._tx = idbTransaction;\n    this.complete = new Promise(function (resolve, reject) {\n      idbTransaction.oncomplete = function () {\n        resolve();\n      };\n\n      idbTransaction.onerror = function () {\n        reject(idbTransaction.error);\n      };\n\n      idbTransaction.onabort = function () {\n        reject(idbTransaction.error);\n      };\n    });\n  }\n\n  Transaction.prototype.objectStore = function () {\n    return new ObjectStore(this._tx.objectStore.apply(this._tx, arguments));\n  };\n\n  proxyProperties(Transaction, '_tx', ['objectStoreNames', 'mode']);\n  proxyMethods(Transaction, '_tx', IDBTransaction, ['abort']);\n\n  function UpgradeDB(db, oldVersion, transaction) {\n    this._db = db;\n    this.oldVersion = oldVersion;\n    this.transaction = new Transaction(transaction);\n  }\n\n  UpgradeDB.prototype.createObjectStore = function () {\n    return new ObjectStore(this._db.createObjectStore.apply(this._db, arguments));\n  };\n\n  proxyProperties(UpgradeDB, '_db', ['name', 'version', 'objectStoreNames']);\n  proxyMethods(UpgradeDB, '_db', IDBDatabase, ['deleteObjectStore', 'close']);\n\n  function DB(db) {\n    this._db = db;\n  }\n\n  DB.prototype.transaction = function () {\n    return new Transaction(this._db.transaction.apply(this._db, arguments));\n  };\n\n  proxyProperties(DB, '_db', ['name', 'version', 'objectStoreNames']);\n  proxyMethods(DB, '_db', IDBDatabase, ['close']); // Add cursor iterators\n  // TODO: remove this once browsers do the right thing with promises\n\n  ['openCursor', 'openKeyCursor'].forEach(function (funcName) {\n    [ObjectStore, Index].forEach(function (Constructor) {\n      // Don't create iterateKeyCursor if openKeyCursor doesn't exist.\n      if (!(funcName in Constructor.prototype)) return;\n\n      Constructor.prototype[funcName.replace('open', 'iterate')] = function () {\n        var args = toArray(arguments);\n        var callback = args[args.length - 1];\n        var nativeObject = this._store || this._index;\n        var request = nativeObject[funcName].apply(nativeObject, args.slice(0, -1));\n\n        request.onsuccess = function () {\n          callback(request.result);\n        };\n      };\n    });\n  }); // polyfill getAll\n\n  [Index, ObjectStore].forEach(function (Constructor) {\n    if (Constructor.prototype.getAll) return;\n\n    Constructor.prototype.getAll = function (query, count) {\n      var instance = this;\n      var items = [];\n      return new Promise(function (resolve) {\n        instance.iterateCursor(query, function (cursor) {\n          if (!cursor) {\n            resolve(items);\n            return;\n          }\n\n          items.push(cursor.value);\n\n          if (count !== undefined && items.length == count) {\n            resolve(items);\n            return;\n          }\n\n          cursor.continue();\n        });\n      });\n    };\n  });\n\n  function openDb(name, version, upgradeCallback) {\n    var p = promisifyRequestCall(indexedDB, 'open', [name, version]);\n    var request = p.request;\n\n    if (request) {\n      request.onupgradeneeded = function (event) {\n        if (upgradeCallback) {\n          upgradeCallback(new UpgradeDB(request.result, event.oldVersion, request.transaction));\n        }\n      };\n    }\n\n    return p.then(function (db) {\n      return new DB(db);\n    });\n  }\n\n  function deleteDb(name) {\n    return promisifyRequestCall(indexedDB, 'deleteDatabase', [name]);\n  }\n\n  exports.openDb = openDb;\n  exports.deleteDb = deleteDb;\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n});","require(\"core-js/modules/es.array.reduce\");\n\nexports.__esModule = true;\nexports.warn = exports.requestAnimationFrame = exports.reducePropsToState = exports.mapStateOnServer = exports.handleClientStateChange = exports.convertReactPropstoHtmlAttributes = undefined;\n\nvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) {\n  return typeof obj;\n} : function (obj) {\n  return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n};\n\nvar _extends = Object.assign || function (target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = arguments[i];\n\n    for (var key in source) {\n      if (Object.prototype.hasOwnProperty.call(source, key)) {\n        target[key] = source[key];\n      }\n    }\n  }\n\n  return target;\n};\n\nvar _react = require(\"react\");\n\nvar _react2 = _interopRequireDefault(_react);\n\nvar _objectAssign = require(\"object-assign\");\n\nvar _objectAssign2 = _interopRequireDefault(_objectAssign);\n\nvar _HelmetConstants = require(\"./HelmetConstants.js\");\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    default: obj\n  };\n}\n\nvar encodeSpecialCharacters = function encodeSpecialCharacters(str) {\n  var encode = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : true;\n\n  if (encode === false) {\n    return String(str);\n  }\n\n  return String(str).replace(/&/g, \"&amp;\").replace(/</g, \"&lt;\").replace(/>/g, \"&gt;\").replace(/\"/g, \"&quot;\").replace(/'/g, \"&#x27;\");\n};\n\nvar getTitleFromPropsList = function getTitleFromPropsList(propsList) {\n  var innermostTitle = getInnermostProperty(propsList, _HelmetConstants.TAG_NAMES.TITLE);\n  var innermostTemplate = getInnermostProperty(propsList, _HelmetConstants.HELMET_PROPS.TITLE_TEMPLATE);\n\n  if (innermostTemplate && innermostTitle) {\n    // use function arg to avoid need to escape $ characters\n    return innermostTemplate.replace(/%s/g, function () {\n      return innermostTitle;\n    });\n  }\n\n  var innermostDefaultTitle = getInnermostProperty(propsList, _HelmetConstants.HELMET_PROPS.DEFAULT_TITLE);\n  return innermostTitle || innermostDefaultTitle || undefined;\n};\n\nvar getOnChangeClientState = function getOnChangeClientState(propsList) {\n  return getInnermostProperty(propsList, _HelmetConstants.HELMET_PROPS.ON_CHANGE_CLIENT_STATE) || function () {};\n};\n\nvar getAttributesFromPropsList = function getAttributesFromPropsList(tagType, propsList) {\n  return propsList.filter(function (props) {\n    return typeof props[tagType] !== \"undefined\";\n  }).map(function (props) {\n    return props[tagType];\n  }).reduce(function (tagAttrs, current) {\n    return _extends({}, tagAttrs, current);\n  }, {});\n};\n\nvar getBaseTagFromPropsList = function getBaseTagFromPropsList(primaryAttributes, propsList) {\n  return propsList.filter(function (props) {\n    return typeof props[_HelmetConstants.TAG_NAMES.BASE] !== \"undefined\";\n  }).map(function (props) {\n    return props[_HelmetConstants.TAG_NAMES.BASE];\n  }).reverse().reduce(function (innermostBaseTag, tag) {\n    if (!innermostBaseTag.length) {\n      var keys = Object.keys(tag);\n\n      for (var i = 0; i < keys.length; i++) {\n        var attributeKey = keys[i];\n        var lowerCaseAttributeKey = attributeKey.toLowerCase();\n\n        if (primaryAttributes.indexOf(lowerCaseAttributeKey) !== -1 && tag[lowerCaseAttributeKey]) {\n          return innermostBaseTag.concat(tag);\n        }\n      }\n    }\n\n    return innermostBaseTag;\n  }, []);\n};\n\nvar getTagsFromPropsList = function getTagsFromPropsList(tagName, primaryAttributes, propsList) {\n  // Calculate list of tags, giving priority innermost component (end of the propslist)\n  var approvedSeenTags = {};\n  return propsList.filter(function (props) {\n    if (Array.isArray(props[tagName])) {\n      return true;\n    }\n\n    if (typeof props[tagName] !== \"undefined\") {\n      warn(\"Helmet: \" + tagName + \" should be of type \\\"Array\\\". Instead found type \\\"\" + _typeof(props[tagName]) + \"\\\"\");\n    }\n\n    return false;\n  }).map(function (props) {\n    return props[tagName];\n  }).reverse().reduce(function (approvedTags, instanceTags) {\n    var instanceSeenTags = {};\n    instanceTags.filter(function (tag) {\n      var primaryAttributeKey = void 0;\n      var keys = Object.keys(tag);\n\n      for (var i = 0; i < keys.length; i++) {\n        var attributeKey = keys[i];\n        var lowerCaseAttributeKey = attributeKey.toLowerCase(); // Special rule with link tags, since rel and href are both primary tags, rel takes priority\n\n        if (primaryAttributes.indexOf(lowerCaseAttributeKey) !== -1 && !(primaryAttributeKey === _HelmetConstants.TAG_PROPERTIES.REL && tag[primaryAttributeKey].toLowerCase() === \"canonical\") && !(lowerCaseAttributeKey === _HelmetConstants.TAG_PROPERTIES.REL && tag[lowerCaseAttributeKey].toLowerCase() === \"stylesheet\")) {\n          primaryAttributeKey = lowerCaseAttributeKey;\n        } // Special case for innerHTML which doesn't work lowercased\n\n\n        if (primaryAttributes.indexOf(attributeKey) !== -1 && (attributeKey === _HelmetConstants.TAG_PROPERTIES.INNER_HTML || attributeKey === _HelmetConstants.TAG_PROPERTIES.CSS_TEXT || attributeKey === _HelmetConstants.TAG_PROPERTIES.ITEM_PROP)) {\n          primaryAttributeKey = attributeKey;\n        }\n      }\n\n      if (!primaryAttributeKey || !tag[primaryAttributeKey]) {\n        return false;\n      }\n\n      var value = tag[primaryAttributeKey].toLowerCase();\n\n      if (!approvedSeenTags[primaryAttributeKey]) {\n        approvedSeenTags[primaryAttributeKey] = {};\n      }\n\n      if (!instanceSeenTags[primaryAttributeKey]) {\n        instanceSeenTags[primaryAttributeKey] = {};\n      }\n\n      if (!approvedSeenTags[primaryAttributeKey][value]) {\n        instanceSeenTags[primaryAttributeKey][value] = true;\n        return true;\n      }\n\n      return false;\n    }).reverse().forEach(function (tag) {\n      return approvedTags.push(tag);\n    }); // Update seen tags with tags from this instance\n\n    var keys = Object.keys(instanceSeenTags);\n\n    for (var i = 0; i < keys.length; i++) {\n      var attributeKey = keys[i];\n      var tagUnion = (0, _objectAssign2.default)({}, approvedSeenTags[attributeKey], instanceSeenTags[attributeKey]);\n      approvedSeenTags[attributeKey] = tagUnion;\n    }\n\n    return approvedTags;\n  }, []).reverse();\n};\n\nvar getInnermostProperty = function getInnermostProperty(propsList, property) {\n  for (var i = propsList.length - 1; i >= 0; i--) {\n    var props = propsList[i];\n\n    if (props.hasOwnProperty(property)) {\n      return props[property];\n    }\n  }\n\n  return null;\n};\n\nvar reducePropsToState = function reducePropsToState(propsList) {\n  return {\n    baseTag: getBaseTagFromPropsList([_HelmetConstants.TAG_PROPERTIES.HREF], propsList),\n    bodyAttributes: getAttributesFromPropsList(_HelmetConstants.ATTRIBUTE_NAMES.BODY, propsList),\n    defer: getInnermostProperty(propsList, _HelmetConstants.HELMET_PROPS.DEFER),\n    encode: getInnermostProperty(propsList, _HelmetConstants.HELMET_PROPS.ENCODE_SPECIAL_CHARACTERS),\n    htmlAttributes: getAttributesFromPropsList(_HelmetConstants.ATTRIBUTE_NAMES.HTML, propsList),\n    linkTags: getTagsFromPropsList(_HelmetConstants.TAG_NAMES.LINK, [_HelmetConstants.TAG_PROPERTIES.REL, _HelmetConstants.TAG_PROPERTIES.HREF], propsList),\n    metaTags: getTagsFromPropsList(_HelmetConstants.TAG_NAMES.META, [_HelmetConstants.TAG_PROPERTIES.NAME, _HelmetConstants.TAG_PROPERTIES.CHARSET, _HelmetConstants.TAG_PROPERTIES.HTTPEQUIV, _HelmetConstants.TAG_PROPERTIES.PROPERTY, _HelmetConstants.TAG_PROPERTIES.ITEM_PROP], propsList),\n    noscriptTags: getTagsFromPropsList(_HelmetConstants.TAG_NAMES.NOSCRIPT, [_HelmetConstants.TAG_PROPERTIES.INNER_HTML], propsList),\n    onChangeClientState: getOnChangeClientState(propsList),\n    scriptTags: getTagsFromPropsList(_HelmetConstants.TAG_NAMES.SCRIPT, [_HelmetConstants.TAG_PROPERTIES.SRC, _HelmetConstants.TAG_PROPERTIES.INNER_HTML], propsList),\n    styleTags: getTagsFromPropsList(_HelmetConstants.TAG_NAMES.STYLE, [_HelmetConstants.TAG_PROPERTIES.CSS_TEXT], propsList),\n    title: getTitleFromPropsList(propsList),\n    titleAttributes: getAttributesFromPropsList(_HelmetConstants.ATTRIBUTE_NAMES.TITLE, propsList)\n  };\n};\n\nvar rafPolyfill = function () {\n  var clock = Date.now();\n  return function (callback) {\n    var currentTime = Date.now();\n\n    if (currentTime - clock > 16) {\n      clock = currentTime;\n      callback(currentTime);\n    } else {\n      setTimeout(function () {\n        rafPolyfill(callback);\n      }, 0);\n    }\n  };\n}();\n\nvar cafPolyfill = function cafPolyfill(id) {\n  return clearTimeout(id);\n};\n\nvar requestAnimationFrame = typeof window !== \"undefined\" ? window.requestAnimationFrame || window.webkitRequestAnimationFrame || window.mozRequestAnimationFrame || rafPolyfill : global.requestAnimationFrame || rafPolyfill;\nvar cancelAnimationFrame = typeof window !== \"undefined\" ? window.cancelAnimationFrame || window.webkitCancelAnimationFrame || window.mozCancelAnimationFrame || cafPolyfill : global.cancelAnimationFrame || cafPolyfill;\n\nvar warn = function warn(msg) {\n  return console && typeof console.warn === \"function\" && console.warn(msg);\n};\n\nvar _helmetCallback = null;\n\nvar handleClientStateChange = function handleClientStateChange(newState) {\n  if (_helmetCallback) {\n    cancelAnimationFrame(_helmetCallback);\n  }\n\n  if (newState.defer) {\n    _helmetCallback = requestAnimationFrame(function () {\n      commitTagChanges(newState, function () {\n        _helmetCallback = null;\n      });\n    });\n  } else {\n    commitTagChanges(newState);\n    _helmetCallback = null;\n  }\n};\n\nvar commitTagChanges = function commitTagChanges(newState, cb) {\n  var baseTag = newState.baseTag,\n      bodyAttributes = newState.bodyAttributes,\n      htmlAttributes = newState.htmlAttributes,\n      linkTags = newState.linkTags,\n      metaTags = newState.metaTags,\n      noscriptTags = newState.noscriptTags,\n      onChangeClientState = newState.onChangeClientState,\n      scriptTags = newState.scriptTags,\n      styleTags = newState.styleTags,\n      title = newState.title,\n      titleAttributes = newState.titleAttributes;\n  updateAttributes(_HelmetConstants.TAG_NAMES.BODY, bodyAttributes);\n  updateAttributes(_HelmetConstants.TAG_NAMES.HTML, htmlAttributes);\n  updateTitle(title, titleAttributes);\n  var tagUpdates = {\n    baseTag: updateTags(_HelmetConstants.TAG_NAMES.BASE, baseTag),\n    linkTags: updateTags(_HelmetConstants.TAG_NAMES.LINK, linkTags),\n    metaTags: updateTags(_HelmetConstants.TAG_NAMES.META, metaTags),\n    noscriptTags: updateTags(_HelmetConstants.TAG_NAMES.NOSCRIPT, noscriptTags),\n    scriptTags: updateTags(_HelmetConstants.TAG_NAMES.SCRIPT, scriptTags),\n    styleTags: updateTags(_HelmetConstants.TAG_NAMES.STYLE, styleTags)\n  };\n  var addedTags = {};\n  var removedTags = {};\n  Object.keys(tagUpdates).forEach(function (tagType) {\n    var _tagUpdates$tagType = tagUpdates[tagType],\n        newTags = _tagUpdates$tagType.newTags,\n        oldTags = _tagUpdates$tagType.oldTags;\n\n    if (newTags.length) {\n      addedTags[tagType] = newTags;\n    }\n\n    if (oldTags.length) {\n      removedTags[tagType] = tagUpdates[tagType].oldTags;\n    }\n  });\n  cb && cb();\n  onChangeClientState(newState, addedTags, removedTags);\n};\n\nvar flattenArray = function flattenArray(possibleArray) {\n  return Array.isArray(possibleArray) ? possibleArray.join(\"\") : possibleArray;\n};\n\nvar updateTitle = function updateTitle(title, attributes) {\n  if (typeof title !== \"undefined\" && document.title !== title) {\n    document.title = flattenArray(title);\n  }\n\n  updateAttributes(_HelmetConstants.TAG_NAMES.TITLE, attributes);\n};\n\nvar updateAttributes = function updateAttributes(tagName, attributes) {\n  var elementTag = document.getElementsByTagName(tagName)[0];\n\n  if (!elementTag) {\n    return;\n  }\n\n  var helmetAttributeString = elementTag.getAttribute(_HelmetConstants.HELMET_ATTRIBUTE);\n  var helmetAttributes = helmetAttributeString ? helmetAttributeString.split(\",\") : [];\n  var attributesToRemove = [].concat(helmetAttributes);\n  var attributeKeys = Object.keys(attributes);\n\n  for (var i = 0; i < attributeKeys.length; i++) {\n    var attribute = attributeKeys[i];\n    var value = attributes[attribute] || \"\";\n\n    if (elementTag.getAttribute(attribute) !== value) {\n      elementTag.setAttribute(attribute, value);\n    }\n\n    if (helmetAttributes.indexOf(attribute) === -1) {\n      helmetAttributes.push(attribute);\n    }\n\n    var indexToSave = attributesToRemove.indexOf(attribute);\n\n    if (indexToSave !== -1) {\n      attributesToRemove.splice(indexToSave, 1);\n    }\n  }\n\n  for (var _i = attributesToRemove.length - 1; _i >= 0; _i--) {\n    elementTag.removeAttribute(attributesToRemove[_i]);\n  }\n\n  if (helmetAttributes.length === attributesToRemove.length) {\n    elementTag.removeAttribute(_HelmetConstants.HELMET_ATTRIBUTE);\n  } else if (elementTag.getAttribute(_HelmetConstants.HELMET_ATTRIBUTE) !== attributeKeys.join(\",\")) {\n    elementTag.setAttribute(_HelmetConstants.HELMET_ATTRIBUTE, attributeKeys.join(\",\"));\n  }\n};\n\nvar updateTags = function updateTags(type, tags) {\n  var headElement = document.head || document.querySelector(_HelmetConstants.TAG_NAMES.HEAD);\n  var tagNodes = headElement.querySelectorAll(type + \"[\" + _HelmetConstants.HELMET_ATTRIBUTE + \"]\");\n  var oldTags = Array.prototype.slice.call(tagNodes);\n  var newTags = [];\n  var indexToDelete = void 0;\n\n  if (tags && tags.length) {\n    tags.forEach(function (tag) {\n      var newElement = document.createElement(type);\n\n      for (var attribute in tag) {\n        if (tag.hasOwnProperty(attribute)) {\n          if (attribute === _HelmetConstants.TAG_PROPERTIES.INNER_HTML) {\n            newElement.innerHTML = tag.innerHTML;\n          } else if (attribute === _HelmetConstants.TAG_PROPERTIES.CSS_TEXT) {\n            if (newElement.styleSheet) {\n              newElement.styleSheet.cssText = tag.cssText;\n            } else {\n              newElement.appendChild(document.createTextNode(tag.cssText));\n            }\n          } else {\n            var value = typeof tag[attribute] === \"undefined\" ? \"\" : tag[attribute];\n            newElement.setAttribute(attribute, value);\n          }\n        }\n      }\n\n      newElement.setAttribute(_HelmetConstants.HELMET_ATTRIBUTE, \"true\"); // Remove a duplicate tag from domTagstoRemove, so it isn't cleared.\n\n      if (oldTags.some(function (existingTag, index) {\n        indexToDelete = index;\n        return newElement.isEqualNode(existingTag);\n      })) {\n        oldTags.splice(indexToDelete, 1);\n      } else {\n        newTags.push(newElement);\n      }\n    });\n  }\n\n  oldTags.forEach(function (tag) {\n    return tag.parentNode.removeChild(tag);\n  });\n  newTags.forEach(function (tag) {\n    return headElement.appendChild(tag);\n  });\n  return {\n    oldTags: oldTags,\n    newTags: newTags\n  };\n};\n\nvar generateElementAttributesAsString = function generateElementAttributesAsString(attributes) {\n  return Object.keys(attributes).reduce(function (str, key) {\n    var attr = typeof attributes[key] !== \"undefined\" ? key + \"=\\\"\" + attributes[key] + \"\\\"\" : \"\" + key;\n    return str ? str + \" \" + attr : attr;\n  }, \"\");\n};\n\nvar generateTitleAsString = function generateTitleAsString(type, title, attributes, encode) {\n  var attributeString = generateElementAttributesAsString(attributes);\n  var flattenedTitle = flattenArray(title);\n  return attributeString ? \"<\" + type + \" \" + _HelmetConstants.HELMET_ATTRIBUTE + \"=\\\"true\\\" \" + attributeString + \">\" + encodeSpecialCharacters(flattenedTitle, encode) + \"</\" + type + \">\" : \"<\" + type + \" \" + _HelmetConstants.HELMET_ATTRIBUTE + \"=\\\"true\\\">\" + encodeSpecialCharacters(flattenedTitle, encode) + \"</\" + type + \">\";\n};\n\nvar generateTagsAsString = function generateTagsAsString(type, tags, encode) {\n  return tags.reduce(function (str, tag) {\n    var attributeHtml = Object.keys(tag).filter(function (attribute) {\n      return !(attribute === _HelmetConstants.TAG_PROPERTIES.INNER_HTML || attribute === _HelmetConstants.TAG_PROPERTIES.CSS_TEXT);\n    }).reduce(function (string, attribute) {\n      var attr = typeof tag[attribute] === \"undefined\" ? attribute : attribute + \"=\\\"\" + encodeSpecialCharacters(tag[attribute], encode) + \"\\\"\";\n      return string ? string + \" \" + attr : attr;\n    }, \"\");\n    var tagContent = tag.innerHTML || tag.cssText || \"\";\n    var isSelfClosing = _HelmetConstants.SELF_CLOSING_TAGS.indexOf(type) === -1;\n    return str + \"<\" + type + \" \" + _HelmetConstants.HELMET_ATTRIBUTE + \"=\\\"true\\\" \" + attributeHtml + (isSelfClosing ? \"/>\" : \">\" + tagContent + \"</\" + type + \">\");\n  }, \"\");\n};\n\nvar convertElementAttributestoReactProps = function convertElementAttributestoReactProps(attributes) {\n  var initProps = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n  return Object.keys(attributes).reduce(function (obj, key) {\n    obj[_HelmetConstants.REACT_TAG_MAP[key] || key] = attributes[key];\n    return obj;\n  }, initProps);\n};\n\nvar convertReactPropstoHtmlAttributes = function convertReactPropstoHtmlAttributes(props) {\n  var initAttributes = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n  return Object.keys(props).reduce(function (obj, key) {\n    obj[_HelmetConstants.HTML_TAG_MAP[key] || key] = props[key];\n    return obj;\n  }, initAttributes);\n};\n\nvar generateTitleAsReactComponent = function generateTitleAsReactComponent(type, title, attributes) {\n  var _initProps; // assigning into an array to define toString function on it\n\n\n  var initProps = (_initProps = {\n    key: title\n  }, _initProps[_HelmetConstants.HELMET_ATTRIBUTE] = true, _initProps);\n  var props = convertElementAttributestoReactProps(attributes, initProps);\n  return [_react2.default.createElement(_HelmetConstants.TAG_NAMES.TITLE, props, title)];\n};\n\nvar generateTagsAsReactComponent = function generateTagsAsReactComponent(type, tags) {\n  return tags.map(function (tag, i) {\n    var _mappedTag;\n\n    var mappedTag = (_mappedTag = {\n      key: i\n    }, _mappedTag[_HelmetConstants.HELMET_ATTRIBUTE] = true, _mappedTag);\n    Object.keys(tag).forEach(function (attribute) {\n      var mappedAttribute = _HelmetConstants.REACT_TAG_MAP[attribute] || attribute;\n\n      if (mappedAttribute === _HelmetConstants.TAG_PROPERTIES.INNER_HTML || mappedAttribute === _HelmetConstants.TAG_PROPERTIES.CSS_TEXT) {\n        var content = tag.innerHTML || tag.cssText;\n        mappedTag.dangerouslySetInnerHTML = {\n          __html: content\n        };\n      } else {\n        mappedTag[mappedAttribute] = tag[attribute];\n      }\n    });\n    return _react2.default.createElement(type, mappedTag);\n  });\n};\n\nvar getMethodsForTag = function getMethodsForTag(type, tags, encode) {\n  switch (type) {\n    case _HelmetConstants.TAG_NAMES.TITLE:\n      return {\n        toComponent: function toComponent() {\n          return generateTitleAsReactComponent(type, tags.title, tags.titleAttributes, encode);\n        },\n        toString: function toString() {\n          return generateTitleAsString(type, tags.title, tags.titleAttributes, encode);\n        }\n      };\n\n    case _HelmetConstants.ATTRIBUTE_NAMES.BODY:\n    case _HelmetConstants.ATTRIBUTE_NAMES.HTML:\n      return {\n        toComponent: function toComponent() {\n          return convertElementAttributestoReactProps(tags);\n        },\n        toString: function toString() {\n          return generateElementAttributesAsString(tags);\n        }\n      };\n\n    default:\n      return {\n        toComponent: function toComponent() {\n          return generateTagsAsReactComponent(type, tags);\n        },\n        toString: function toString() {\n          return generateTagsAsString(type, tags, encode);\n        }\n      };\n  }\n};\n\nvar mapStateOnServer = function mapStateOnServer(_ref) {\n  var baseTag = _ref.baseTag,\n      bodyAttributes = _ref.bodyAttributes,\n      encode = _ref.encode,\n      htmlAttributes = _ref.htmlAttributes,\n      linkTags = _ref.linkTags,\n      metaTags = _ref.metaTags,\n      noscriptTags = _ref.noscriptTags,\n      scriptTags = _ref.scriptTags,\n      styleTags = _ref.styleTags,\n      _ref$title = _ref.title,\n      title = _ref$title === undefined ? \"\" : _ref$title,\n      titleAttributes = _ref.titleAttributes;\n  return {\n    base: getMethodsForTag(_HelmetConstants.TAG_NAMES.BASE, baseTag, encode),\n    bodyAttributes: getMethodsForTag(_HelmetConstants.ATTRIBUTE_NAMES.BODY, bodyAttributes, encode),\n    htmlAttributes: getMethodsForTag(_HelmetConstants.ATTRIBUTE_NAMES.HTML, htmlAttributes, encode),\n    link: getMethodsForTag(_HelmetConstants.TAG_NAMES.LINK, linkTags, encode),\n    meta: getMethodsForTag(_HelmetConstants.TAG_NAMES.META, metaTags, encode),\n    noscript: getMethodsForTag(_HelmetConstants.TAG_NAMES.NOSCRIPT, noscriptTags, encode),\n    script: getMethodsForTag(_HelmetConstants.TAG_NAMES.SCRIPT, scriptTags, encode),\n    style: getMethodsForTag(_HelmetConstants.TAG_NAMES.STYLE, styleTags, encode),\n    title: getMethodsForTag(_HelmetConstants.TAG_NAMES.TITLE, {\n      title: title,\n      titleAttributes: titleAttributes\n    }, encode)\n  };\n};\n\nexports.convertReactPropstoHtmlAttributes = convertReactPropstoHtmlAttributes;\nexports.handleClientStateChange = handleClientStateChange;\nexports.mapStateOnServer = mapStateOnServer;\nexports.reducePropsToState = reducePropsToState;\nexports.requestAnimationFrame = requestAnimationFrame;\nexports.warn = warn;"],"sourceRoot":""}